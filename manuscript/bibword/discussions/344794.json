[
  {
    "Id": "799733",
    "ThreadId": "344794",
    "Html": "<p>Hello Yves,</p>\n<p>thank you for advice with ISBN/ISSN script, you showed me principles under the hood of your templates and therefor I found another ideas, what I would like implement, but I meet some troubles, since I'am not experienced with xsl.</p>\n<p>For example, I want to implement code, that search field Year and if there is letter \"c\", then write copyright sign befor year. I think that I fail to properly use string $year and I need some help with &lt;xsl:value-of select&gt;. Here is the code, that I wrote  and is not working.</p>\n<p>&nbsp;</p>\n<div style=\"color: black; background-color: white;\">\n<pre> <span style=\"color: green;\">&lt;!-- Handle years and years accessed. --&gt;</span>\n<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">when</span> <span style=\"color: red;\">test</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">starts-with($name, 'Year') and string($source/*[local-name() = $name])</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\n                    <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">value-of</span> <span style=\"color: red;\">select</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">translate($source/*[local-name() = $name], 'cC()-1234567890', '&amp;copy;&amp;copy;')</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">/&gt;</span>\n                    <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">call-template</span> <span style=\"color: red;\">name</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">format-year</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\n                      <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">with-param</span> <span style=\"color: red;\">name</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">year</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">select</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">translate($source/*[local-name() = $name], 'cC()-&amp;copy;', '')</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">/&gt;</span>\n                      <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">with-param</span> <span style=\"color: red;\">name</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">options</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">select</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">$options</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">/&gt;</span>\n                    <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">call-template</span><span style=\"color: blue;\">&gt;</span>\n                  <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">when</span><span style=\"color: blue;\">&gt;</span>\n</pre>\n</div>\n<p>&nbsp;</p>\n<p>It is inserted into your code, that you use for Year and YearAccessed. In our citation norm, we sometimes need to add dash and or copyright symbol to the year field, and because you handle with Years as numbers, I need to clean parameter year for template  operations. I tried to use translate function.</p>\n<p>Then, if in $source/b:Year exists letter \"c\" (or (c). C, (C)), a want to write copyright symbol befor year. I tried to use function translate as well, but with no success (as well).</p>\n<p>At last, but not least, I want to add dash at the end of year, in some fields with new option e.g. \":d\", if there is no dash in year field. This is for citation of Periodical or Journal sources, where our norm need to specific years, for which the source was printed  (e.g. 1987-1996) and if it is still printed, then add only year of beginning and dash behind it (e.g. 1987- ), so, if someone insert only year of begining and forget to insert dash, it would be inserted automaticaly. This one I &nbsp;would solve as xsl:when test for option 'd' and if true, test for contains dash if not, add &lt;xsl:text&gt;&amp;dash;&lt;/xsl:text&gt; at the end.</p>",
    "PostedDate": "2012-02-25T00:14:47.317-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]