[
  {
    "Id": "220898",
    "ThreadId": "64869",
    "Html": "<p>If this post appears twice, sorry. My computer hiccuped and it looked like the text was lost before posting.</p>\r\n<p>I have only just started using the bibliography feature of Word 2007. I have several questions:</p>\r\n<p>Q1: I want to keep the year date next to the author at the beginning, but we prefer to show month at the tail end instead. Using &quot;Report&quot; as source, if I include the month in the &quot;date&quot; field, it also shows up in the citation, and at the beginning by the author. Is there a way to create a new field called &quot;month&quot; and get it to display at the end? Or is there another field I could cheat and use that would display at the end? I tried using the &quot;pages&quot; field but it inserted a &quot;pp.&quot; in front.</p>\r\n<p><strong>Sapere Consulting, Inc. (Sapere). 2006.</strong> <em>Environmental Baseline Report. </em>2006.</p>\r\n<p>&nbsp;</p>\r\n<p>Q2: When citing the same author multiple times, it only gives the author name in the first instance, after that, it uses dashes, as shown below. Is there a way around this?</p>\r\n<p><strong>Client. 2007 HH.</strong> <em>Development and Use of Risk-Based Preliminary Remediation Goals for Ecological Risk Assessment. </em>2007 HH. SLAC-I-750-3A33H-017.</p>\r\n<p><strong>&mdash;. 2002.</strong> <em>Celebrating 40 Years: A Photo History. </em>[ed.] Jean Marie Deken. 2002. SLAC-R-605.</p>\r\n<p>&nbsp;</p>\r\n<p>Q3: Some of our reports have ID numbers we need to display. I want the ID number to show just before the date, the date should be last item. In the example below, I used the &quot;standard number&quot; field in &quot;report&quot; source.</p>\r\n<p><strong>Client. 2007.</strong> <em>Development and Use of Risk-Based Preliminary Remediation Goals for Ecological Risk Assessment. </em>2007 HH. SLAC-I-750-3A33H-017.</p>\r\n<p>&nbsp;</p>\r\n<p>Any help you can give this newbie would be appreciated.</p>",
    "PostedDate": "2009-08-07T12:07:55.97-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "220959",
    "ThreadId": "64869",
    "Html": "<p>That's one of the default Word styles. I don't really look at those anymore because their formatting is way too complex to rule out every exception. If you want to reorder elements, my opinion is to either start from scratch, or use a BibWord style where it is a lot easier to move things around.</p>\r\n<p>I can give you some quick pointers:</p>\r\n<p>Regarding Q1:</p>\r\n<p>There is no &quot;date&quot; field in the input form. Day, Month, and Year are three separate fields. It might not be possible to enter the month field as in, it might be invisible. In such a case, you could always try to switch temporarely to another source type which does have it, fill in the month there and switch back to the intended source type. Word will store the month correctly. Of course, if the field is not available in the first place, there is a good chance that it won't be displayed by the style either. If that is the case, you will have to find out everywhere the year is displayed and add the month if required.</p>\r\n<p>If you are only going to use the style on your own machine, then you might want to edit the bibform.xml file so the month field becomes available for your type.</p>\r\n<p>&nbsp;</p>\r\n<p>Regarding Q2:</p>\r\n<p>The dashes are made by calling the <em>templ_prop_ISO690_SameAuthor</em> template. So what you will want to do is looking for lines which look similar to the following:</p>\r\n<pre></pre>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">call-template</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">templ_prop_ISO690_SameAuthor</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n</pre>\r\n</div>\r\n<p>There should be two instances (one for journal articles and conference proceedings, and one for all the rest). On closer inspection, you will see that those calls are wrapped inside <span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span>&nbsp;statements which check if the previous work has the same author/title. Without doing major testing, I'm assuming that removing the entire when-clause should result in the author/title to be always shown rather than the dashes.</p>\r\n<p>&nbsp;</p>\r\n<p>Regarding Q3:</p>\r\n<p>That means an entire reordering of elements. Not a good idea with the predefined types.&nbsp;You will have to figure out where/when each element is displayed and then move them around. Most 'elements' are formatted beforehand after which they are all&nbsp;displayed in the order according to their type. The specific display order can often be found in the when-clause starting with code looking like this</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span> <span style=\"color:Red\">test</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">b:SourceType='Report'</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>where 'Report' can be any of the predefined types ('Book', 'JournalArticle', ...). You will have to check what happens with the separators (periods, commas, ...) on a case by case basis.</p>\r\n<p>For 'Report' you could probably move StandardNumber to just behind DepartmentAndInstitution. So something along the following lines:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>...\r\n<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">value-of</span> <span style=\"color:Red\">select</span> <span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">$DepartmentAndInstitution</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">value-of</span> <span style=\"color:Red\">select</span> <span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">$StandardNumber</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">call-template</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">'</span><span style=\"color:Blue\">PrintList</span><span style=\"color:Black\">'</span><span style=\"color:Blue\">&gt;</span>\r\n...</pre>\r\n</div>\r\n<p>Note that the separators between the fields might be broken though.</p>",
    "PostedDate": "2009-08-07T15:35:41.4-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "220994",
    "ThreadId": "64869",
    "Html": "<p>Thank you so much for the tips. Multiple users, and thus multiple computers, will be using this style.</p>\r\n<p>After evaluating the Bibword styles, I found that Harvard Anglia took care of two of my problems (thank you so much, whoever made that style). It now repeats the author names, instead of dashes, for subsequent entries. And the second instance of the year has disappeared.</p>\r\n<p>I also found that I could get things to display in the order I wanted by putting them into different fields. If I enter the month in the comment field, it appears as the last item. And if I put the ID Number into the Report Type field, that works. My output now looks like:</p>\r\n<p>CFN, 2002. <em>Celebrating 40 Years: A Photo History</em>. XXX-R-605. Jean Marie Deken, Senior Editor.</p>\r\n<p>CFN, 2006. <em>The Geology of the Eastern Part of Site</em>. XXX-I-750-3A33X-001. February.</p>\r\n<p>CFN, 2007 HH. <em>Development and Use of Risk-Based Preliminary Remediation Goals for Ecological Risk Assessment.</em> XXX-I-750-3A33H-017. May 22.</p>\r\n<p>Client Fictitious Name (CFN), 1999. <em>Preliminary Site Assessment</em>. XXX-I-750-OA33H-001. October.</p>\r\n<p>&nbsp;</p>\r\n<p>Now I have some *new* questions.</p>\r\n<p>Q1: When the same author has multiple references, it puts them into date order, with oldest date first, as above. Is there a way to reverse the order to most recent date first, instead (2009 would be first, then 2008, 2007, etc.)?</p>\r\n<p>Q2: I would like to change the comma between author name and year to a period instead.&nbsp; Where to make this change?</p>\r\n<p>Q3: We frequently shorten or acronymize author names (these are usually corporate authors) after their first occurrence. This causes two problems. a) authors are put into alphabetical order, so often the full version name will not appear next to the short version name. Anyway to link them or group them, or associate them? and b) the citation for the full version name looks like (Client Fictitious Name (CFN), 1999). Anyway to override this and have it display the short version?</p>\r\n<p>Thank you for your help.</p>",
    "PostedDate": "2009-08-07T17:40:57.667-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "221177",
    "ThreadId": "64869",
    "Html": "<p>Q1:</p>\r\n<p>No not directly. BibWord creates a sortkey string to sort on. So it will always place 2007 before 2008. Actually, even commercial products like EndNote can not do this for the exact same reason.</p>\r\n<p>However, since the styles or actually XSLT code, you could rewrite an entire sorting mechanism the way you want. If you want to&nbsp;put minimal effort into it, you could hack the BibWord engine as follows: look where a <strong>b:SortKey</strong> element is generated and change it value in such a way that entries from 2008 will be placed before 2007. The latter could be achieved by using a simple replacement routine which does a&nbsp;'reverse'&nbsp;before actually writing the value. So that would mean you run a simple string replacement function which replaces 0 by 9, 1 by 8, 2 by 7, 3 by 6, 4 by 5, 5 by 4, 6 by 3, 7 by 2, 8 by 1, and 9 by 0 before assigning the value.</p>\r\n<p>An example:</p>\r\n<p style=\"padding-left:30px\">Doe, 2008&nbsp;&nbsp;&nbsp; would become&nbsp;&nbsp;&nbsp; Doe, 7991</p>\r\n<p style=\"padding-left:30px\">Doe, 2009&nbsp;&nbsp;&nbsp; would become&nbsp;&nbsp;&nbsp; Doe, 7990</p>\r\n<p>When those two entries would be sorted (based on the value of SortKey), &quot;Doe, 7990&quot; would come before &quot;Doe, 7991&quot; resulting in &quot;Doe, 2009&quot; being displayed before &quot;Doe, 2008&quot;.</p>\r\n<p>Q2:</p>\r\n<p>Every formatting in BibWord is stored within the <strong>data</strong> variable. Normally that variable is located at the top of the file. In it, there is a <strong>bibliography</strong> element which contains all formatting info for the bibliography. For each type of sources supported, there is a <strong>format</strong> element containing the specific format string for that source type.</p>\r\n<p>For example, the one for ArticleInAPeriodical in HarvardAnglia looks like this:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">format</span><span style=\"color:Blue\">&gt;</span>{%Author:2|&quot;Anon.&quot;%,}{ %Year|&quot;n.d.&quot;%{%YearSuffix%}.}{ %Title|ShortTitle%.}{ <span style=\"color:Red\">&amp;lt;</span>i<span style=\"color:Red\">&amp;gt;</span>%PeriodicalTitle%<span style=\"color:Red\">&amp;lt;</span>/i<span style=\"color:Red\">&amp;gt;</span>,}{ [%Medium%]}{ {%Day% }%Month:s%.}{ %Pages:p.:pp.:a2%}.{ Available at: <span style=\"color:Red\">&amp;lt;</span>u<span style=\"color:Red\">&amp;gt;</span>%URL:l%<span style=\"color:Red\">&amp;lt;</span>/u<span style=\"color:Red\">&amp;gt;</span>}{ [Accessed{{ %DayAccessed%} %MonthAccessed:s%} %YearAccessed%]}.{ %Comments%.}<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">format</span><span style=\"color:Blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>To change your &quot;,&quot; into &quot;.&quot;, you just have to change it where the author is displayed. So</p>\r\n<p style=\"padding-left:30px\">{%Author:2|&quot;Anon.&quot;%<strong>,</strong>}</p>\r\n<p>would become</p>\r\n<p style=\"padding-left:30px\">{%Author:2|&quot;Anon.&quot;%<strong>.</strong>}</p>\r\n<p>Don't worry that there will be 2 periods if a work is anonymous. BibWord will clean that up for you.</p>\r\n<p>Q3:</p>\r\n<p>No. Not using BibWord. Again, if you would write your entire style from scratch in XSLT, this is something you could do.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-08-08T16:19:15.543-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "221178",
    "ThreadId": "64869",
    "Html": "<p>Note regarding Q1, rather than a replacement at the end, you could temporarly replace the value of b:Year to (9999 - b:Year). This would probably require the least code.</p>",
    "PostedDate": "2009-08-08T16:28:11.267-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "221694",
    "ThreadId": "64869",
    "Html": "I did a search for b:Year and don't see where its value is assigned. Where in the following code (taken out of the Harvard Anglia style sheet) would I make this replacement? <br><br>&lt;!--  Sort the elements for YearSuffix. <br>  --&gt; <br>- &lt;xsl:variable name=&quot;sortedForYearSuffix&quot;&gt;<br>- <br>- &lt;xsl:for-each select=&quot;msxsl:node-set($withBibOrder)/b:BibWord/b:Source&quot;&gt;<br>- &lt;!--  Sort by YSReq first to group entries which might require year suffices. <br>  --&gt; <br>  &lt;xsl:sort select=&quot;b:YSReq&quot; data-type=&quot;text&quot; /&gt; <br>  &lt;xsl:sort select=&quot;b:SortKey&quot; data-type=&quot;text&quot; /&gt; <br>- <br>- &lt;!--  Copy all elements. <br>  --&gt; <br>- &lt;xsl:for-each select=&quot;./*&quot;&gt;<br>  &lt;xsl:copy-of select=&quot;.&quot; /&gt; <br>  &lt;/xsl:for-each&gt;<br>  <br>  &lt;/xsl:for-each&gt;<br>  <br>  &lt;/xsl:variable&gt;<br>- &lt;!--  Add the YearSuffix element. <br>  --&gt; <br>- <br>- &lt;xsl:for-each select=&quot;msxsl:node-set($sortedForYearSuffix)/b:BibWord/b:Source&quot;&gt;<br>- <br>- &lt;!--  Copy all elements except for YSReq and SortKey. <br>  --&gt; <br>- &lt;xsl:for-each select=&quot;./*&quot;&gt;<br>- &lt;xsl:if test=&quot;local-name() != 'YSReq' and local-name() != 'SortKey'&quot;&gt;<br>  &lt;xsl:copy-of select=&quot;.&quot; /&gt; <br>  &lt;/xsl:if&gt;<br>  &lt;/xsl:for-each&gt;<br>- &lt;!--  Add the YearSuffix element. <br>  --&gt; <br>- <br>  &lt;xsl:variable name=&quot;current&quot; select=&quot;./b:YSReq&quot; /&gt; <br>  &lt;xsl:variable name=&quot;previous&quot; select=&quot;preceding-sibling::b:Source[1]/b:YSReq&quot; /&gt; <br>  &lt;xsl:variable name=&quot;next&quot; select=&quot;following-sibling::b:Source[1]/b:YSReq&quot; /&gt; <br>- &lt;xsl:choose&gt;<br>- &lt;!--  Continuation of a series. <br>  --&gt; <br>- &lt;xsl:when test=&quot;position() &gt; 1 and $current = $previous&quot;&gt;<br>- &lt;xsl:call-template name=&quot;get-year-suffix&quot;&gt;<br>  &lt;xsl:with-param name=&quot;index&quot; select=&quot;position()&quot; /&gt; <br>  &lt;xsl:with-param name=&quot;bibWord&quot; select=&quot;$sortedForYearSuffix&quot; /&gt; <br>  &lt;/xsl:call-template&gt;<br>  &lt;/xsl:when&gt;<br>- &lt;!--  First in a series. <br>  --&gt; <br>- &lt;xsl:when test=&quot;last() &gt; position() and $current = $next&quot;&gt;<br>  &lt;xsl:text&gt;a&lt;/xsl:text&gt; <br>  &lt;/xsl:when&gt;<br>- &lt;!--  Not part of a series, the element is empty. <br>  --&gt; <br>  &lt;xsl:otherwise /&gt; <br>  &lt;/xsl:choose&gt;<br>  <br>  <br>  &lt;/xsl:for-each&gt;<br>  <br>  &lt;/xsl:template&gt;<br><br><br>&gt;&gt;&gt; yves &lt;notifications@codeplex.com&gt; 8/8/2009 4:28 pm &gt;&gt;&gt;<br>From: yves<br><br>Note regarding Q1, rather than a replacement at the end, you could temporarly replace the value of b:Year to (9999 - b:Year). This would probably require the least code. <br><br>",
    "PostedDate": "2009-08-10T13:21:39.87-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "221883",
    "ThreadId": "64869",
    "Html": "<p>Nowhere. This is the code that decides on the year suffix to display (and requires the Extender tool to run properly).</p>\r\n<p>What you need is to adapt the value of the year that is used when the <strong>b:SortKey</strong> element is generated. You want your year to be &quot;inverted&quot; (9999-Year) there so that they get ordered differently. Currently the b:SortKey element gets generated in two places.</p>\r\n<p>If I have some time today or tomorrow I'll try to move all the SortKey stuff into one template function. It should be a nice code cleanup and it should be a lot easier to make the adjustment you require.</p>",
    "PostedDate": "2009-08-10T23:23:54.13-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "222153",
    "ThreadId": "64869",
    "Html": "<p>You can find a version of Harvard Anglia at <a href=\"http://allserv.ugent.be/~ydhondt\">http://allserv.ugent.be/~ydhondt</a>&nbsp;which might do the trick for you. The entire sortkey generation process is now defined in the template &quot;create-sortkey&quot; at the bottom of the stylesheet. A special adaption was done to substract the year from 9999 and thereby achieve a reversed order.</p>\r\n<p>This version will only be there for a couple of days before it will probably get removed.</p>",
    "PostedDate": "2009-08-11T11:57:20.397-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "222268",
    "ThreadId": "64869",
    "Html": "Thanks Yves, I downloaded it and will check it out.<br><br>&gt;&gt;&gt; yves &lt;notifications@codeplex.com&gt; 8/11/2009 11:57 am &gt;&gt;&gt;<br>From: yves<br><br>You can find a version of Harvard Anglia at<br>http://allserv.ugent.be/~ydhondt which might do the trick for you.<br>The entire sortkey generation process is now defined in the template<br>&quot;create-sortkey&quot; at the bottom of the stylesheet. A special adaption was<br>done to substract the year from 9999 and thereby achieve a reversed<br>order.This version will only be there for a couple of days before it<br>will probably get removed. <br><br>",
    "PostedDate": "2009-08-11T17:10:31.37-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "225659",
    "ThreadId": "64869",
    "Html": "<p>Yves,</p>\r\n<p>The version of Harvard Anglia you suggested did fix the date order, now they are reversed, just the way I wanted them. I have made the other edits I had previously made to change field output order, commas vs. periods, etc.</p>\r\n<p>I want to add a lower-case letter as a year suffix for multiple instances of same author in same year. I have downloaded and installed BibWord extender, but can't seem to get it to work. I generated my bibliography, then closed word. Opened the Bibworder Extender2.exe file to run the program, pointed it at where the style sheets are on the C drive, then from within the BibWord extender dialog box, selected the Word doc containing my bibliography. It gave me this error message:</p>\r\n<p>&quot;Unhandled exception has occurred in your application. If you click Continue, the application will ignore this error and attempt to continue. If you click Quit, the application will close immediately.</p>\r\n<p>Could not load file or assembly 'WindowsBase, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35' or one of its dependencies. The system cannot find the file specified.&quot;</p>\r\n<p><span id=\"ctl00_ctl00_MasterContent_Content_wikiSourceLabel\"><strong><strong></strong></strong>Could it have something to do with defining both the <em>sortkey</em> and the <em>yearsuffix</em> element in the style sheet first??? If so, where do I do that?<br></span></p>",
    "PostedDate": "2009-08-19T17:25:20.533-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "225735",
    "ThreadId": "64869",
    "Html": "<p>It sounds as if you don't have the .Net framework 3.5 (which contains WindowsBase.dll) installed. See the requirements section at <a href=\"http://bibword.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24823\">http://bibword.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24823</a></p>",
    "PostedDate": "2009-08-19T23:26:54.677-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]