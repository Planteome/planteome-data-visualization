[
  {
    "Id": "94556",
    "ThreadId": "28347",
    "Html": "Is it possible to add automatically sorting by last name and not by citations appearance in the document ?\r\n",
    "PostedDate": "2008-05-24T09:08:15.033-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "94669",
    "ThreadId": "28347",
    "Html": "<br>\r\n<div style=\"border-right:medium none;padding-right:0.2em;border-top:#aaa 0.1em dotted;padding-left:0.2em;padding-bottom:0.2em;margin:1em 0em 2.5em 3em;border-left:medium none;padding-top:0.2em;border-bottom:#aaa 0.1em dotted;font-style:italic\"><br>\r\nkaratist wrote:<br>\r\nIs it possible to add automatically sorting by last name and not by citations appearance in the document ? <br>\r\n<br>\r\n</div>\r\n<br>\r\nI do not really understand how you would cite your sources using numbers and then create a bibliography which has a different order than your numbers.<br>\r\n<br>\r\nA bibliography is currently sorted using the following line in the for-each loop:<br>\r\n<span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"><br>\r\n</span></span>\r\n<p><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">  xsl:sort</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"> </span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">select</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">b:RefOrder</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"> </span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">data-type</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">number</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"><br>\r\n</span></span><br>\r\nSo you could adjust this line for your needs. As a start, something like the following line could work:<br>\r\n<br>\r\n<span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\"><span style=\"color:#0000ff\">  </span>xsl:sort</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"> </span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">select</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">b:Author/b:Auhtor/b:Person[1]/b:Last</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"> </span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">data-type</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">text</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"><br>\r\n</span></span><br>\r\nHowever, each item in a bibliography has a reference number while not every entry might have an 'person author'. The author might be a corporation, an editor or might even be missing. So when you want to sort on anything other than reference order, you will need to define exactly how the sorting should be done.<br>\r\n<br>\r\nI am currently working on a stylesheet for the Harvard reference model. There the sorting has to be done in the way you request. It will probably take a few weeks before I will release something. Mainly because I can not figure out the correct formatting for Harvard style (each publication authority seems to have its own reference to it). I already solved the sorting problem as follows: before entering the for-each loop of the bibliography, I extend each source with an extra field (b:ExtSortKey) which is filled with a string which is a combination of author or editor last names, title, and year of publication. Then the sorting for the for-each loop becomes:<br>\r\n<br>\r\n<span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">  xsl:sort</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"> </span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">select</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">b:ExtSortKey</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"> </span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">data-type</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">text</span></span><span style=\"font-size:13px\">&quot;</span><br>\r\n<br>\r\nIf you want the full example, I can probably put a beta version of the style sheet up by the beginning of June.</p>\r\n",
    "PostedDate": "2008-05-25T15:35:04.277-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "94928",
    "ThreadId": "28347",
    "Html": "<p>I added an <a href=\"http://www.codeplex.com/bibliography/Release/ProjectReleases.aspx?ReleaseId=13789\" title=\"Template with extended capabilities\">advanced stylesheet template</a> to the project. Among things, it contains the extension functionality I talked about in my previous post. It also contains an example on how to use it to sort bibliography entries based on year and title.</p>\r\n<p>Hopefully this can help you with what you want to accomplish.<br>\r\n<span style=\"font-size:10px\"></span><br>\r\n<span style=\"font-size:10px\"><em>edit for spelling mistake (short =&gt; sort)</em></span></p>\r\n",
    "PostedDate": "2008-05-27T07:47:13.967-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "95136",
    "ThreadId": "28347",
    "Html": "<br>\r\n<div style=\"border-right:medium none;padding-right:0.2em;border-top:#aaa 0.1em dotted;padding-left:0.2em;padding-bottom:0.2em;margin:1em 0em 2.5em 3em;border-left:medium none;padding-top:0.2em;border-bottom:#aaa 0.1em dotted;font-style:italic\">Thank you for your reply, I will be happy to get a beta version. Regarding the sorting - this is exactly what LaTeX is doing, and this is what I need for my thesis. The bibliography list should be sorted by last name AND only then the numbers should be given to all items of the list. This way it will be sorted both by numbers and by last name.<br>\r\n<br>\r\nYou are doing a great job, thank you.<br>\r\n</div>\r\n",
    "PostedDate": "2008-05-27T23:44:11.763-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "95975",
    "ThreadId": "28347",
    "Html": "<p>I went over the bst stylesheet you send me and now have a clear grasp of what you want to achieve. <br>\r\n<br>\r\nUnfortunately, what you require is not automatically possible using Word 2007 as far as I can tell. Sorting the elements in the bibliography is easy. The problem is the numbering of in-text citations afterwards. In Word 2007, in-text citations are independant from bibliographies. So it is not possible to communicate the position of an entry in the bibliography, to a b:Citation element. Hence, it is impossible for a bibliography to tell which value should be placed between brackets in a in-text citation. Also, a b:Citation element contains only one b:Source element. So sorting all b:Source elements to calculate a number every time you wish to display an in-text citation is not possible either (let alone the computational complexity of this solution). Finally, the b:RefOrder element indicates the order of the appearance of b:Source elements in the text and not in the bibliography. So that value can not be used either.<br>\r\n<br>\r\n<a href=\"http://office.microsoft.com/en-us/word/HA100674921033.aspx\" title=\"Create a bibliography\">Indirectly Microsoft admits to know about the issue</a> with the following quote:<br>\r\n  &quot;If you choose a GOST or ISO 690 style for your sources and a citation is not unique, append an alphabetic character to the year. For example, a citation would appear as [Pasteur, 1848a].&quot;<br>\r\n<br>\r\nSo they admit it is not possible to access the other sources within a b:Citation element. What is even more strange, if you are able to add the &quot;a&quot; to the year in the in-text citation, you should also be able to add it to the year in the bibliography. Something which is not possible.<br>\r\n<br>\r\nAt the moment I can see one solution which requires you to do a lot of work when you finished your document: </p>\r\n<ul>\r\n    <li>create your text with in-text citations </li>\r\n    <li>generate your bibliography in the format you want </li>\r\n    <li>use the numbers from the generated bibliography and add them as suffixes of citations while surpressing all other info (\\s &lt;number&gt; \\n \\t \\y) </li>\r\n</ul>\r\n<p>Like I said, a lot of postprocessing work since you have to handle every entry separately, but it should do the trick.</p>\r\n",
    "PostedDate": "2008-05-31T06:50:01.76-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "97432",
    "ThreadId": "28347",
    "Html": "<p>Unfortunately, I didn't succeed to do the trick.<br>\r\n<br>\r\nI have several questions:</p>\r\n<ol>\r\n    <li>How can I generate my bibliography in the format I want ? (Tell me if I understand right - I changed the sorting order in XLS file to select=&quot;b:Author&quot;).</li>\r\n    <li>When I add at least one citation, &quot;RefOrder&quot; of all bibliography is automatically changed (the cited one became the first one). I added to the citation field &quot;\\s 5&quot;, for example, but this did not help.</li>\r\n</ol>\r\n<p>Can you please elaborate on what did you mean ?<br>\r\n<br>\r\nThank you.</p>\r\n",
    "PostedDate": "2008-06-07T11:50:45.187-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "97538",
    "ThreadId": "28347",
    "Html": "Regarding your first point:<br>\r\nLike I posted before, you cannot just simply sort on an element. There is no guarantee that the element will be available or contain data. In the <em>Advanced Stylesheet Template</em> I have put up an illustration on sorting based on a key. You will have to define the key yourself for your case though. <br>\r\n<br>\r\nSimply sorting on the 'text' version of a b:Source/b:Author element is pointless since there no guarantee that the 'real' authors are listed as a first element. For all you know, it could be of the format: <br>\r\n<span style=\"font-size:11px\">    <br>\r\n    &lt;b:Author&gt;<br>\r\n      &lt;b:Translator&gt;...&lt;/b:Translator<br>\r\n      &lt;b:Editor&gt;...&lt;/b:Editor<br>\r\n      &lt;b:Author&gt;...&lt;/b:Author&gt;<br>\r\n    &lt;b:Author&gt; <br>\r\n<br>\r\n</span>which would imply that this source would be sorted based on translator rather than author. Even a 'text' version of b:Source/b:Author/b:Author can not be used as a sorting key since some books have no authors but just editors, while patents have inventors rather than authors. So as you can see, obtaining a value for your sorting key should be done rather carefully. <br>\r\n<br>\r\nYou can try your b:Author and hope for the best, but if everything turns out fine, it's just a lucky shot. Also, on that line you have to switch the data-type from &quot;number&quot; to &quot;text&quot;. And you can no longer use RefOrder in the first column of the table since those are now unordered if you sort on the authors.<br>\r\n<br>\r\nRegarding your second point: <br>\r\nIn the IEEE.xsl stylesheet, there is no support for \\s (or \\f for that matter). I did not add any, because there is no requirement for it in the IEEE style. You can easily add support for it yourself though. For the IEEE stylesheet, you would have to replace:<br>\r\n        &lt;<span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">xsl:value-of</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"> </span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">select</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">/b:Citation/b:Source/b:RefOrder</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">/&gt;</span></span><br>\r\nby:<br>\r\n<span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">        &lt;</span></span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">xsl:if</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"> </span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">test</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">/b:Citation/b:PagePrefix</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n            &lt;</span></span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">xsl:value-of</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"> </span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">select</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">/b:Citation/b:PagePrefix</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"> </span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">disable-output-escaping</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">yes</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">/&gt;<br>\r\n        &lt;/</span></span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">xsl:if</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n</span></span>        <span style=\"font-size:13px;color:#0000ff\">&lt;</span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">xsl:value-of</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"> </span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">select</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">/b:Citation/b:Source/b:RefOrder</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">/&gt;<br>\r\n</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">        &lt;</span></span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">xsl:if</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"> </span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">test</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">/b:Citation/b:PageSuffix</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">&gt;<br>\r\n            &lt;</span></span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">xsl:value-of</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"> </span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">select</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">/b:Citation/b:PageSuffix</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\"> </span></span><span style=\"font-size:13px;color:#ff0000\"><span style=\"font-size:13px;color:#ff0000\">disable-output-escaping</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">=</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">yes</span></span><span style=\"font-size:13px\">&quot;</span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">/&gt;<br>\r\n        &lt;/</span></span><span style=\"font-size:13px;color:#2b91af\"><span style=\"font-size:13px;color:#2b91af\">xsl:if</span></span><span style=\"font-size:13px;color:#0000ff\"><span style=\"font-size:13px;color:#0000ff\">&gt;</span></span><br>\r\nin the citation formatting.<br>\r\n<br>\r\nAlternatively, when you finished writing your text and generated your bibliography, you can convert it to static text and then manually edit/replace every in-text citation with the value you want. That at least gets your bibliography formatted correctly. For that matter, I would display something else than b:RefOrder as intermediate value for the in-text citations. Something which will allow you to map it more easily to entries in the bibliography (tag, first author, title, ...) <br>\r\n<br>\r\n<span style=\"font-size:10px\">(edit error in code)</span>\r\n",
    "PostedDate": "2008-06-08T15:02:13.027-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "102277",
    "ThreadId": "28347",
    "Html": "I have done my own style, and everything looks just as I want it to. Just one thing left. The pagenumbers. How can I print the page numbers that are induvidual for each reference. Thus, I dont want to print out the page numbers that can be set in the source manager. Does anyone know what this paremeter is named or know&nbsp;another way to print the numbers? I know I can type them in manually, but anyway, would be nice to solve it.<br>\r\n<br>\r\nThank you in advance!\r\n",
    "PostedDate": "2008-07-02T15:32:26.243-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "102774",
    "ThreadId": "28347",
    "Html": "The page numbers of a source are stored in <em>/b:Citation/b:Source/b:Pages</em>.<br>\r\n<br>\r\nThe page numbers entered with the \\p switch of the citation field (or by&nbsp;right-clicking an in-text citation and picking &quot;Edit Citation&quot; instead of &quot;Edit Source&quot;) are stored in <em>/b:Citation/b:Pages</em>.<br>\r\n<br>\r\nHTH\r\n",
    "PostedDate": "2008-07-04T13:24:38.76-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "105520",
    "ThreadId": "28347",
    "Html": "<br>\r\n<div style=\"border-right:medium none;padding-right:0.2em;border-top:#aaa 0.1em dotted;padding-left:0.2em;padding-bottom:0.2em;margin:1em 0em 2.5em 3em;border-left:medium none;padding-top:0.2em;border-bottom:#aaa 0.1em dotted;font-style:italic\"><br>\r\nkaratist wrote:<br>\r\n<br>\r\n<div style=\"border-right:medium none;padding-right:0.2em;border-top:#aaa 0.1em dotted;padding-left:0.2em;padding-bottom:0.2em;margin:1em 0em 2.5em 3em;border-left:medium none;padding-top:0.2em;border-bottom:#aaa 0.1em dotted;font-style:italic\">...&nbsp;The bibliography list should be sorted by last name AND only then the numbers should be given to all items of the list. This way it will be sorted both by numbers and by last name.<br>\r\n<br>\r\n</div>\r\n</div>\r\n<br>\r\n<br>\r\nThere is solution, but unfortunately it doesn´t use bibliography functionality so it's on you to watch correct citation style. You can use combination of numbered list and cross reference. Just create list of sources with any kind of numbering:<br>\r\n<ol>\r\n    <li>abc</li>\r\n    <li>bcd</li>\r\n    <li>...</li>\r\n</ol>\r\n<p>Then you can create cross reference to number of paragraph from list (e.g. it shows 1 for item 'abc'). When you add new item to&nbsp;the end of the&nbsp;list, simply sort the list by paragraph:</p>\r\n<ol>\r\n    <li>aaa</li>\r\n    <li>abc</li>\r\n    <li>bcd</li>\r\n    <li>...</li>\r\n</ol>\r\n<p>Because every item&nbsp;has it's own reference number which is independent on rank in the list your cross reference can point to this new place but it also can&nbsp;take new ordered&nbsp;number of paragraph. Cross reference will be changed after updating of fields or re-opening of document&nbsp;(e.g. 1 will be changed to 2 for item 'abc'). </p>\r\n",
    "PostedDate": "2008-07-17T15:40:27.907-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]