[
  {
    "Id": "916794",
    "ThreadId": "396707",
    "Html": "\r\n<p><span style=\"font-size:10pt\">Hi folks,</span></p>\r\n<p><span style=\"font-size:10pt\">First, thank you so much for developing this tool. it's been extremely helpful and exciting. &nbsp;&nbsp;</span></p>\r\n<p><span style=\"font-size:10pt\">&nbsp;</span><span style=\"font-size:10pt\">I don't know XML well, but I know some rudiments of coding, so i've been able to edit the Harvard Anglia style to do a number of things to match my company's referencing style using BibExtender.\r\n &nbsp;Aside from simple formatting thing, the main thing I've been able to change is to get the bibliography to sort first alphabetically, and then by the year suffix. To do this, I changed the sortkey element to this:</span></p>\r\n<p><span style=\"font-size:10pt\">&lt;sortkey&gt;{%Author:2|InternetSiteTitle|&quot;Anon.&quot;%.}{ %Year|&quot;n.d.&quot;%{%YearSuffix%}&lt;/sortkey&gt;</span></p>\r\n<p><span style=\"font-size:10pt\">This also has another intended effect, which is that the first in-text citation's suffix is &quot;a&quot; and then goes in order from there. Before, it would have been strictly alphabetical, so the first citation may have been (Source,\r\n 2012e), instead of (Source, 2012a). &nbsp;</span></p>\r\n<p><span style=\"font-size:10pt\">So, this is all working perfectly well for me, except for one thing: if I have more than &quot;source type&quot; by the same author and year, they do not sort with each other. &nbsp;For example, I'll have a slew of &quot;DocumentFromInternetSite&quot;\r\n sources that are sorted appropriately with suffixes a-c, and then it will restart the letter suffix lettering with a different source type e.g. &quot;Report&quot;. &nbsp;Basically it would like this:</span></p>\r\n<p><span style=\"font-size:10pt\">Author, 2012a. title. Website link.</span></p>\r\n<p><span style=\"font-size:10pt\">Author, 2012b. title. Website link. </span></p>\r\n<p><span style=\"font-size:10pt\">Author, 2012c. title. Website link. </span></p>\r\n<p><span style=\"font-size:10pt\">Author, 2012a. title. [NO LINK TO WEB BECAUSE IT IS A REPORT]</span></p>\r\n<p><span style=\"font-size:10pt\">I&rsquo;ve uploaded my version of the XML file here in case that is helpful: http://www.downstreamstrategies.com/HarvardAnglia.XSL</span></p>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2012-09-24T11:12:24.903-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "917237",
    "ThreadId": "396707",
    "Html": "<p>Can't you adapt your sortkey to incorporate the source type? So everything is first sorted by author, then by type, and finally by year.&nbsp;So</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">sortkey</span><span style=\"color: blue;\">&gt;</span>{%Author:2|InternetSiteTitle|\"Anon.\"%.}{ %Year|\"n.d.\"%{%YearSuffix%}<strong>}</strong><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">sortkey</span><span style=\"color: blue;\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>would become something like</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">sortkey</span><span style=\"color: blue;\">&gt;</span>{%Author:2|InternetSiteTitle|\"Anon.\"%.}{ %SourceType%}{ %Year|\"n.d.\"%{%YearSuffix%}<strong>}</strong><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">sortkey</span><span style=\"color: blue;\">&gt;</span></pre>\r\n</div>\r\n<p><strong>NOTE: you are missing a matching closing bracket in your sortkeys! There should be another } after the YearSuffix element.</strong></p>\r\n<p>I'm not sure why you include the year suffix in the sort key, the sort key is actually part of what will decide on what the suffix will be. But if it works, leave it :-)</p>",
    "PostedDate": "2012-09-25T06:49:51.133-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "917293",
    "ThreadId": "396707",
    "Html": "<p>Hi Yves,</p>\r\n<p>Thanks for your help. &nbsp;I tried two things: 1) replaced the missing bracket and re-ran that way, and also tried the new code you provided, but no luck. &nbsp;I can't give you a really good reason WHY i used suffix code in the sort, other than I thought it might work, and it almost did, but the fact that it won't effectively ignore source type when applying suffixes is keeping it from being useful. &nbsp;</p>\r\n<p>Have any other ideas for how I could make that work?</p>\r\n<p>Best,</p>\r\n<p>Nate</p>",
    "PostedDate": "2012-09-25T08:01:53.727-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "917462",
    "ThreadId": "396707",
    "Html": "<p>I'm confused. Do you want the suffices to restart per type or not?</p>\r\n<p>Do you want</p>\r\n<p style=\"padding-left: 30px;\"><span style=\"font-size: 10pt;\">Author, 2012a. title. Website link.<br /></span><span style=\"font-size: 10pt;\">Author, 2012b. title. Website link. <br /></span><span style=\"font-size: 10pt;\">Author, 2012c. title. Website link. <br /></span><span style=\"font-size: 10pt;\">Author, 2012a. title. [NO LINK TO WEB BECAUSE IT IS A REPORT]</span></p>\r\n<p><span style=\"font-size: 10pt;\">or do you want</span></p>\r\n<p style=\"padding-left: 30px;\"><span style=\"font-size: 10pt;\">Author, 2012a. title. Website link.<br /></span><span style=\"font-size: 10pt;\">Author, 2012b. title. Website link. <br /></span><span style=\"font-size: 10pt;\">Author, 2012c. title. Website link.<br /></span><span style=\"font-size: 10pt;\">Author, 2012d. title. [NO LINK TO WEB BECAUSE IT IS A REPORT]</span></p>\r\n<p><span style=\"font-size: 10pt;\">What exactly are you sorting criteria and their order?</span></p>\r\n<p style=\"padding-left: 30px;\"><span style=\"font-size: 10pt;\">1. Author<br />2. Year<br />3. SourceType?<br />4. Title?</span></p>",
    "PostedDate": "2012-09-25T13:12:06.97-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "917470",
    "ThreadId": "396707",
    "Html": "<p>I'm sorry for not being clear. I do NOT want the suffices to restart. &nbsp;The second list is what I would prefer. &nbsp;Basically, I want sourcetype to be ignored. Bibliography should be sorted first by author, then by year, then by reference order. The suffixes should also be determined by reference order.&nbsp;In other words, the first reference in the doc by the same author-year would appear as (Author, 2012a), whereas the 5th reference in the doc &nbsp;by the same author-year would be (Author, 2012e), regardless of the source type.&nbsp;</p>",
    "PostedDate": "2012-09-25T13:20:40.983-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "917840",
    "ThreadId": "396707",
    "Html": "<p>I took a better look at your style.</p>\r\n<p>For starters, you are using an old version of BibWord (2.5). The current version is 2.8 and contains several fixes and extra features. Upgrading is straightforward, just download the latest style template and replace the data element (&lt;xsl:variable name=\"data\"&gt;...&lt;/xsl:variable&gt;) with yours. Styles are backwards compatible.</p>\r\n<p>Next stop sorting. You are using the same sortkey everywhere. That makes no sense. For example, a book has no InternetSiteTitle so that field will always be empty. Why would you include it in your sortkey? The same for using the author field in a movie. You would either sort on title or on producer.</p>\r\n<p>There is a limitation in using the reference order in your sorting keys. The problem is that sorting keys are seen as strings, so if you would have 'author, year, order' and the following two entries 'author1, 2012, 5' and 'author1, 2012, 12', the second one would come for the first one as 1 is lower than 5. So I extended the template with an extra function to format the reference order:</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: green;\">&lt;!-- Formats a reference order number. --&gt;</span>\r\n<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">template</span> <span style=\"color: red;\">name</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">format-reforder</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\r\n  <span style=\"color: green;\">&lt;!-- A reforder to format. --&gt;</span>\r\n  <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">param</span> <span style=\"color: red;\">name</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">reforder</span><span style=\"color: black;\">\"</span> <span style=\"color: blue;\">/&gt;</span>\r\n  <span style=\"color: green;\">&lt;!-- Options for reforder formatting. --&gt;</span>\r\n  <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">param</span> <span style=\"color: red;\">name</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">options</span><span style=\"color: black;\">\"</span> <span style=\"color: blue;\">/&gt;</span>\r\n \r\n  <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">choose</span><span style=\"color: blue;\">&gt;</span>\r\n    <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">when</span> <span style=\"color: red;\">test</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">contains($options, 'l')</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\r\n      <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">value-of</span> <span style=\"color: red;\">select</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">substring(concat('00000', $reforder), string-length($reforder) + 1, 5)</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">/&gt;</span>\r\n    <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">when</span><span style=\"color: blue;\">&gt;</span>\r\n    <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">otherwise</span><span style=\"color: blue;\">&gt;</span>\r\n      <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">value-of</span> <span style=\"color: red;\">select</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">$reforder</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">/&gt;</span>\r\n    <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">otherwise</span><span style=\"color: blue;\">&gt;</span>\r\n  <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">choose</span><span style=\"color: blue;\">&gt;</span>\r\n<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">template</span><span style=\"color: blue;\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>Basically, if you provide an l switch the number will be formatted as a 5 digit number with leading zeroes.</p>\r\n<p>You have to be careful with sorting if your citations don't display authors in the same way as your bibliography. In your style only the first author is shown if there are more than two. So if you had two entries by \"A, B, C\" and \"A, D, E\", they would both end up in your in-text citation as \"A et al.\".</p>\r\n<p>I went over some of your sortkeys and changed them a liitle:</p>\r\n<p>ArticleInAPeriodical: {%Author:2|Title|\"Anon.\"%}{ %Year|\"n.d.\"%}{ %RefOrder:l%}<br />Book: {%Author:2|Title|\"Anon.\"%.}{ %Year|\"n.d.\"%}{ %RefOrder:l%}<br />BookSection: {%Author:2|Editor:2|Title|\"Anon.\"%.}{ %Year|\"n.d.\"%}{ %RefOrder:l%}<br />ConferenceProceedings: {%Author:2|Title|\"Anon.\"%.}{ %Year|\"n.d.\"%}{ %RefOrder:l%}<br />DocumentFromInternetSite: {%Author:2|InternetSiteTitle|\"Anon.\"%.}{ %Year|\"n.d.\"%}{ %RefOrder:l%}<br />Film: {%Title|\"Anon.\"%.}{ %Year|\"n.d.\"%}{ %RefOrder:l%}<br />InternetSite: {%Author:2|Title|\"Anon.\"%.}{ %Year|\"n.d.\"%}{ %RefOrder:l%}<br />Journal Article: {%Author:2|Title|\"Anon.\"%.}{ %Year|\"n.d.\"%}{ %RefOrder:l%}<br />Report: {%Author:2|Title|\"Anon.\"%.}{ %Year|\"n.d.\"%}{ %RefOrder:l%}</p>\r\n<p>Finally, the suffices. Nothing to change here. Suffices are needed when you have two entries which would look the same as in-text citations if you didn't have them. So basically, the decision is made using the same format string as the one for the citation with the exclusion of the YearSuffix element. After all, this is the element you try to calculate.</p>\r\n<p>I uploaded the adapted style and some sample files to <a href=\"http://www.4shared.com/zip/d8YVPh1C/HarvardAngliaAdapted.html\">http://www.4shared.com/zip/d8YVPh1C/HarvardAngliaAdapted.html</a></p>",
    "PostedDate": "2012-09-26T06:55:51.59-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "918080",
    "ThreadId": "396707",
    "Html": "<p>You've gone above and beyond. I have not tried this yet, but I'm amazed and thankful for your efforts and your patience with my Noobs. I haven't tried this out yet, but will do so soon. &nbsp;I'll let you know how it goes.</p>\r\n<p>Cheers.&nbsp;</p>",
    "PostedDate": "2012-09-26T13:37:15.387-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "989772",
    "ThreadId": "396707",
    "Html": "\r\n<p>Hi ,</p>\r\n<p>I have the same problem with sorting a,b,c in my text.&nbsp; I tried to download the style mentioned in the last link but it doesn't work. Can one of you please upload it again?</p>\r\n<p>Thanks, Zahra</p>\r\n",
    "PostedDate": "2013-01-21T07:53:48.69-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "992616",
    "ThreadId": "396707",
    "Html": "\r\n<p>The original poster was creating his own style based on Harvard Anglia. So I very much doubt you have the same problem. What style are you using and what exactly is your problem?</p>\r\n",
    "PostedDate": "2013-01-27T03:44:50.767-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]