[
  {
    "Id": "787378",
    "ThreadId": "334238",
    "Html": "\r\n<p>This might require quite a bit of fiddling by those who know what they're doing, but: I was wondering if there was a way to incorporate automatic switching between the two styles for abbreviating (US) states. For example, Calif. vs. CA, or Mass. vs. MA.\r\n Some of my journals require one, some the other. I was thinking it could be done by setting up &quot;look-up tables&quot;, perhaps from the full word to a choice of either of those two, and this could all be incorporated into an &quot;option&quot; paramater that you could attach\r\n to the &quot;StateProvince&quot; tag. But I don't know how to do any of this; I also don't know where I would put such code in the BibWord template. Any ideas?</p>\r\n<p>&nbsp;</p>\r\n<p>David</p>\r\n",
    "PostedDate": "2012-02-20T20:39:29.487-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "787958",
    "ThreadId": "334238",
    "Html": "<p>There already exists similar code for handling month names and source types.</p>\r\n<p>If you download the template, you will find an xml part looking like:</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>    <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">strings</span><span style=\"color: blue;\">&gt;</span>\r\n      <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">months</span><span style=\"color: blue;\">&gt;</span>\r\n        <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">month</span> <span style=\"color: red;\">number</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">1</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>Jan<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">month</span><span style=\"color: blue;\">&gt;</span>\r\n        <span style=\"color: green;\">&lt;!-- other months --&gt;</span>\r\n        <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">month</span> <span style=\"color: red;\">number</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">12</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>Dec<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">month</span><span style=\"color: blue;\">&gt;</span>\r\n      <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">months</span><span style=\"color: blue;\">&gt;</span>\r\n      <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">sourcetypes</span><span style=\"color: blue;\">&gt;</span>\r\n        <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">sourcetype</span> <span style=\"color: red;\">type</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">Art</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>Art<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">sourcetype</span><span style=\"color: blue;\">&gt;</span>\r\n        <span style=\"color: green;\">&lt;!-- other source types --&gt;</span>\r\n        <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">sourcetype</span> <span style=\"color: red;\">type</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">SoundRecording</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>Sound Recording<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">sourcetype</span><span style=\"color: blue;\">&gt;</span>\r\n      <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">sourcetypes</span><span style=\"color: blue;\">&gt;</span>\r\n    <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">strings</span><span style=\"color: blue;\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>So you could add a &lt;states&gt; element with the necessary abbreviations. You would then have to write your own format-state template and call that. Something like:</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">states</span><span style=\"color: blue;\">&gt;</span>\r\n  <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">state</span> <span style=\"color: red;\">name</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">alabama</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>AL<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">state</span><span style=\"color: blue;\">&gt;</span>\r\n  <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">state</span> <span style=\"color: red;\">name</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">california</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>CA<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">state</span><span style=\"color: blue;\">&gt;</span>\r\n  <span style=\"color: green;\">&lt;!-- and so on --&gt;</span>\r\n<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">states</span><span style=\"color: blue;\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>First the calling. Look for a piece of code like this:</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: green;\">&lt;!-- Handle months and months accessed. --&gt;</span>\r\n<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">when</span> <span style=\"color: red;\">test</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">starts-with($name, 'Month') and string($source/*[local-name() = $name])</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\r\n  <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">call-template</span> <span style=\"color: red;\">name</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">format-month</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p><strong>Above</strong> it, add something like (untested):</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">when</span> <span style=\"color: red;\">test</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">$name = 'StateProvince' and string($source/b:StateProvince)</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\r\n  <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">variable</span> <span style=\"color: red;\">name</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">state</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">select</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">$source/*[local-name() = $name]</span><span style=\"color: black;\">\"</span> <span style=\"color: blue;\">/&gt;</span>\r\n  <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">value-of</span> <span style=\"color: red;\">select</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">msxsl:node-set($data)/strings/states/state[@name = $state]</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">/&gt;</span>\r\n<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">when</span><span style=\"color: blue;\">&gt;</span>\r\n\r\n</pre>\r\n</div>\r\n<p>You should extend this code to cover your needs: casing, what if names are missing or there is no match, what if you want to be able to disable if for some (option parameter), ...</p>",
    "PostedDate": "2012-02-20T23:06:08.883-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "791099",
    "ThreadId": "334238",
    "Html": "<p>Thanks; I'll try that!</p>",
    "PostedDate": "2012-02-21T11:36:28.857-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]