[
  {
    "Id": "560954",
    "ThreadId": "244704",
    "Html": "\r\n<p>Hello</p>\r\n<p>First off, thank you for making this great project, I first tried a xsl approach and hated it, bibword makes it a lot easier.</p>\r\n<p>So, I know my questions have been asked before, I used the search, but it's all very mixed-up,&nbsp;specialized&nbsp;answers I found, so I would really appreciate any help.</p>\r\n<p>I've created my own bibword xml following the word document the way I like it, all is great, but:</p>\r\n<p>The sorting and display of the bibliography is not the way I need it yet, I'm so close to finishing but just can't get this right. I'll&nbsp;divide my problem into 3 parts</p>\r\n<p>1: Bibwords sorting seems totally random to me, I can not see the logic. So I tried using the &lt;sortkey&gt; element, but somehow I don't understand it: Since sortkey is added to a source element and not the bibliography element, is it different for every\r\n source than? I see no distinction between the sources as is, bibword is freely mixing my internetsites with my books, so why can I give every source a sorting? What I need is to sort by %last (lastname) of the first author when it's books, internetsites by\r\n the %title, but &nbsp;all only alphabetically, and that is it. Can this be done?</p>\r\n<p>2: I must distinguish sources in my bibliography, so I need a literature list, then I need a separate internetsite list. Can this be achived? Even better would be, if I could have a page break between the 2.</p>\r\n<p>3: Finally: If 1 &amp; 2 are done, this would be the icing on the cake: When I insert the bibliography in Word 2010, it automatically adds a heading/title called Bibliography, and makes it a layer 1 title, so it gets the automatic numbering that style has\r\n and gets counted when I generate an index. Once I have a separate Internet Site list, this one also needs a title like that (Websites), I assume somewhere you can add html. Knowing where would be very helpful.&nbsp;And is it even possible to assign the title\r\n a &quot;word layer/format&quot; from xml, so it gets recognized my automatic indexing?</p>\r\n<p>&nbsp;</p>\r\n<p>Thank you for ALL help, I will further explain if i was unclear, just ask.</p>\r\n",
    "PostedDate": "2011-02-04T12:09:06.967-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "561158",
    "ThreadId": "244704",
    "Html": "\r\n<p>1/</p>\r\n<p>Default sorting is based on the reference order of the in-text citations. If you don't display the reference number in front of the sources, then it can indeed seem like the ordering is completely random.</p>\r\n<p>The sortkey is different for every element.&nbsp;&nbsp;There are not enough common elements between sources of a different type to just create one sortkey that fits all. Suppose you want to sort a journal article, a patent, and a film. The journal article\r\n has an author. The patent has no author, but it has an inventor. And the movie has no author and no inventor. But it has a producer which the other two don't have. So you would need 3 keys to&nbsp;be able to sort those&nbsp;3 types of entries among&nbsp;each\r\n other.</p>\r\n<p>You can sort any way you want. For example</p>\r\n<ul>\r\n<li>Books: {%Author:1|Title%} {%Year%} {%Title%} </li><li>InternetSite: {%InternetSiteTitle|Title%}&nbsp;{%Year%} {%Title%} </li></ul>\r\n<p>For easiness assume the 1 behind author to be the same format you use for displaying authors in your text. {%Author:1|Title%} will ensure that the author will be used and if not available the title. {%InternetSiteTitle|Title%} will ensure that the internet\r\n site title is used and if not available the title of the page. So if you would have</p>\r\n<ul>\r\n<li>book 1:&nbsp;John Doe,&nbsp;A mystery novel, 2010. </li><li>book 2: Albert Zola, The history, 2005. </li><li>website 1: White House, <a href=\"http://www.whitehouse.com\">http://www.whitehouse.com</a>, 2008\r\n</li><li>website 2: Glass house, <a href=\"http://www.glasshouse.com\">http://www.glasshouse.com</a>, 2009\r\n</li></ul>\r\n<p>The would be ordered:</p>\r\n<ul>\r\n<li>book 1 (sortkey = Doe 2010 A mystery novel) </li><li>website 2 (sortkey =Glass house 2009) </li><li>website 1 (sortkey =White House 2008) </li><li>book 2 (sortkey =Zola 2005 The history) </li></ul>\r\n<p>2/</p>\r\n<p>To do this, you would need to change your ordering. You would have to sort on source type first. You could easily put %SourceType% at the forn of every sorting key. However, this will group all sources by type. So if you would have books, journal articles,\r\n patents, and websites, the sources would be grouped accordingly.</p>\r\n<p>If you only wanted to group websites and put all the rest together, that would require some creativity. You would have to use %SourceType<strong>:s</strong>% and map every source type to&nbsp;a string. By mapping websites to a &quot;z&quot; and all other types to\r\n an &quot;a&quot;, you would guarantee that&nbsp;only the websites are sorted seperately.</p>\r\n<p>As page breaks are&nbsp;a concept foreign to HTML (with the exception of some printing CSS),&nbsp;I'm not sure you can&nbsp;introduce them.</p>\r\n<p>3/&nbsp;&nbsp;</p>\r\n<p>If all you would need would be 1 title, you should create a simple building block inside Word. There is already for &quot;Bibliography&quot; and &quot;Works Cited&quot; (the latter being a badly chosen title). However, two titles is trickier. This cannot be done by changing\r\n a part of the BibWord engine. However, it has been done before (<a href=\"http://bibword.codeplex.com/Thread/View.aspx?ThreadId=74667\">http://bibword.codeplex.com/Thread/View.aspx?ThreadId=74667</a>) so it shouldn't be that hard. Noticed that in that thread,\r\n I used h4 as heading style. You can use h1, h2, ... They map automatically to the heading styles in your Word document. That should allow them to be incorporated in your TOC by default.</p>\r\n",
    "PostedDate": "2011-02-05T02:30:57.61-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "561546",
    "ThreadId": "244704",
    "Html": "\r\n<p>Thank you <em>very</em> much yves, it took some time, but I think &amp; hope I got it all now.</p>\r\n<p>On 3), I didn't quite understand the passage on building block, in my Word I only see a predefined style for citation, 'bibliography' just gets a normal h1 title style, but this is just want I want anyway.</p>\r\n<p>Anyhow, I followed your other post you linked and I got the XSL working. If it is not one of the 2 sourcetypes I want with a different title (websites and cases) (and logically, those are the 2 types I have given a string=x and string=z for sorting, all\r\n the other are string=a, as you suggested under [2]), I just give an empty &lt;h1&gt; back. Is this a 'dirty' code trick or do you think that is ok and won't give me problems?</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre> <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">if</span> <span style=\"color:red\">test</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">not(./b:SourceType = preceding-sibling::b:Source[1]/b:SourceType)</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span> <span style=\"color:green\">&lt;!--  and (./b:SourceType = 'InternetSite')--&gt;</span>\r\n        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">h1</span><span style=\"color:blue\">&gt;</span>\r\n           <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">choose</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">when</span> <span style=\"color:red\">test</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">./b:SourceType = 'InternetSite'</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">text</span><span style=\"color:blue\">&gt;</span>Webseiten<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">text</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">when</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">when</span> <span style=\"color:red\">test</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">./b:SourceType = 'Case'</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">text</span><span style=\"color:blue\">&gt;</span>Rechtsprechung<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">text</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">when</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t  <span style=\"color:green\">&lt;!-- ... and so on ... --&gt;</span>\r\n\t\t\t  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">otherwise</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t\t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">text</span> <span style=\"color:blue\">/&gt;</span> <span style=\"color:green\">&lt;!-- &lt;xsl:value-of select=&quot;./b:SourceType&quot;/&gt; --&gt;</span>\r\n\t\t\t  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">otherwise</span><span style=\"color:blue\">&gt;</span>\r\n\t\t\t<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">choose</span><span style=\"color:blue\">&gt;</span>\r\n        <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">h1</span><span style=\"color:blue\">&gt;</span>\r\n <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">if</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p></p>\r\n",
    "PostedDate": "2011-02-06T11:31:34.747-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "561601",
    "ThreadId": "244704",
    "Html": "\r\n<p>If it works it's fine. You could actually remove the xsl:otherwise part as it doesn't do a thing.</p>\r\n<p>Personally, I would wrap the h1 tags directly around the titles and not use them otherwise. So</p>\r\n<pre> <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">if</span> <span style=\"color:red\">test</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">not(./b:SourceType = preceding-sibling::b:Source[1]/b:SourceType)</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span> <span style=\"color:green\">&lt;!--  and (./b:SourceType = 'InternetSite')--&gt;</span>\r\n   <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">choose</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\"><span style=\"color:#000000\">     </span>&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">when</span> <span style=\"color:red\">test</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">./b:SourceType = 'InternetSite'</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\"><span style=\"color:#000000\">        </span>&lt;</span><span style=\"color:#a31515\">h1</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">text</span><span style=\"color:blue\">&gt;</span>Webseiten<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">text</span><span style=\"color:blue\">&gt;<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">h1</span><span style=\"color:blue\">&gt;</span></span>\r\n     <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">when</span><span style=\"color:blue\">&gt;</span>\r\n     <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">when</span> <span style=\"color:red\">test</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">./b:SourceType = 'Case'</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\"><span style=\"color:#000000\">        </span>&lt;</span><span style=\"color:#a31515\">h1</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">text</span><span style=\"color:blue\">&gt;</span>Rechtsprechung<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">text</span><span style=\"color:blue\">&gt;<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">h1</span><span style=\"color:blue\">&gt;</span></span>\r\n<span style=\"color:blue\"><span style=\"color:#000000\">     </span>&lt;/</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">when</span><span style=\"color:blue\">&gt;</span>\r\n     <span style=\"color:green\">&lt;!-- ... and so on ... --&gt;</span>\r\n<span style=\"color:blue\"><span style=\"color:#000000\">   </span>&lt;/</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">choose</span><span style=\"color:blue\">&gt;</span>\r\n <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">if</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n",
    "PostedDate": "2011-02-06T13:46:24.367-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "561651",
    "ThreadId": "244704",
    "Html": "\r\n<p>You're version is much cleaner, I implemented that one. Thank you for all you're help yves, much appreciated.</p>\r\n<p>A final heads up for anybody who reads this thread later, I achived the page break. It's not considered a 'clean' way anymore (you should not use clear=all), but it get's the job done:</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">br</span> <span style=\"color:red\">clear</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;all&quot;</span> <span style=\"color:red\">style</span><span style=\"color:blue\">=</span><span style=\"color:blue\">&quot;page-break-before:always&quot;</span> <span style=\"color:blue\">/&gt;<br></span></pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n",
    "PostedDate": "2011-02-06T16:25:13.083-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "562118",
    "ThreadId": "244704",
    "Html": "\r\n<p>One follow-up question: Is it possible to reference another format style other than the headers (h1 - h6) in the xml?</p>\r\n<p>Say I created a style called 'titles' in Word (because I don't want all my sources all to get separate numbers in my index, like they would with a h1 style), can I access this one as well from html? I naturally need the h1 style with numbers for the rest\r\n of the document, so it can't be changed.</p>\r\n<p>(I also use the style for other things than the bibliography, so just giving size/color etc. direct in the xml is too static)</p>\r\n<p>thanks</p>\r\n",
    "PostedDate": "2011-02-07T10:53:31.59-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "562133",
    "ThreadId": "244704",
    "Html": "\r\n<p>There is already such a style called MsoBibliography. It maps in Word to a localized version of the word 'bibliography'.</p>\r\n",
    "PostedDate": "2011-02-07T11:22:26.957-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "562187",
    "ThreadId": "244704",
    "Html": "\r\n<div style=\"color:#000000; font-family:'Segoe UI','Microsoft Sans Serif',Arial,Geneva,sans-serif; font-size:10pt; margin:8px; background-color:#ffffff\">\r\n<p>Sorry to be slow, but I do not see this Bibliography style, you already mentioned something like it in a earlier post, but I have 18 predefined word styles, none are for the bibliography title (but one is for the citation), perhaps it's cause I have a different\r\n language word (<a href=\"http://bibword.codeplex.com/Thread/View.aspx?ThreadId=31497\">http://bibword.codeplex.com/Thread/View.aspx?ThreadId=31497</a>&nbsp;mentioned something similar).</p>\r\n<p>Anyhow, it would be better if I could just&nbsp;assign&nbsp;my 'title' style, because:</p>\r\n<p>Index, Bibliography, Internet Sites and Management Summary need to appear before the paper content _without_ a counter, so no 1., 1.1 etc. This only starts after main paper begins, then I use h1-h3 styles.</p>\r\n<p>It is no problem to give 3 of the 4 a style copied from h1 style without the numbers called 'title' (or anything else, I don't care) in Word (they never 'refresh'), but Internet Sites is generated in my XML by the code above. We assigned it style &lt;h1&gt;,\r\n can I change it to the other style or must I manually set color, size and bold in the xml (which is very&nbsp;inflexible solution)?</p>\r\n<p>But if Word only understands h1 - h6 as styles, then of course nothing can be done?</p>\r\n</div>\r\n",
    "PostedDate": "2011-02-07T12:55:41.833-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "562204",
    "ThreadId": "244704",
    "Html": "\r\n<p>I don't know. It depends on the HTML converter inside Word. It is that converter which does the mapping between the styles you define in your stylesheet and the ones used in your document.</p>\r\n<p>What do you see when you use the style inspector (CTRL&#43;ALT&#43;SHIFT&#43;S to make the style pane appear, the middle button at the bottom)? When your cursor is inside a bibliography entry, it should&nbsp;indicate which style is being used.</p>\r\n",
    "PostedDate": "2011-02-07T13:26:39.083-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "562251",
    "ThreadId": "244704",
    "Html": "\r\n<p>The Title (Bibliography) has:</p>\r\n<p><strong>Paragraph</strong>: Heading 1</p>\r\n<p><strong>Text:</strong> Paragraph-Standart Text</p>\r\n<p>&nbsp;</p>\r\n<p>The actual Bibliography:</p>\r\n<p><strong>Paragraph</strong>: Bibliography</p>\r\n<p><strong>Text:</strong> Paragraph-Standart Text</p>\r\n<p>&nbsp;</p>\r\n<p>*freely translated. I thought perhaps there was some documentation I didn't have about html -&gt; word, guess not though:P Tried &lt;titel&gt; instead of &lt;h1&gt;, didn't work:)</p>\r\n<p>Pure guesswork, nothing to do with bibword: (edit: seems like I was wrong with this)</p>\r\n<p>I have never worked with Paragraph Styles (seen them right now for the first time), so I'm not sure what they are / where they come in handy, but I'm gonna look into it, cause if I see correct, the 'text style' is only valid for the 'paragraph style'. So\r\n if I *could* define a different heading 1 style for all the page paragraphs above the main part (remove the numbers / counting), I could continue to use &lt;h1&gt; in the xml. Mind you, I have never seen anything like changing heading text styles depending\r\n on which part / paragraph of a word document you are in.</p>\r\n",
    "PostedDate": "2011-02-07T14:45:27.82-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "565488",
    "ThreadId": "244704",
    "Html": "<p>Another brief question I found while working and can't get to work:</p>\r\n<p>&nbsp;</p>\r\n<p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">sortkey</span><span style=\"color: blue;\">&gt;</span>{%SourceType:s%}{%Author:2|InternetSiteTitle%}{%InternetSiteTitle%}{%URL%}<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">sortkey</span><span style=\"color: blue;\">&gt;</span>\r\n</pre>\r\n</div>\r\n</p>\r\n<p>is my current Webpage sorting. The problem is wit the author / internetsitetitle. What happens is, all pages with an Author get displayed alphabetically, and then the pages without an author get displayed alphabetically by InternetSiteTitle.</p>\r\n<p>I would like it, that these 2 are mixed. So if there is an Author, it is primery sortkey and than internettitle (incease multiple pages by same author). But if there is no author, internetsitetitle goes on the same hierarchy as the author in the sorting.</p>\r\n<p>The result should look like:</p>\r\n<p>Adam, a frist page, www.....</p>\r\n<p>Adam, z is importantant, www.....</p>\r\n<p><strong>Clouds are nice</strong>, www....</p>\r\n<p>Mark, water is nice, www....</p>\r\n<p>&nbsp;</p>\r\n<p>etc.</p>\r\n<p>&nbsp;</p>\r\n<p>thanks for any help!</p>",
    "PostedDate": "2011-02-13T11:13:49.433-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "565683",
    "ThreadId": "244704",
    "Html": "<p>If that is the format string you are using, then they should be mixed.</p>\r\n<p>Note that&nbsp; it isn't even necessary to use the \"|InternetSiteTitle\" part as if there is no author, nothing will be returned for that part and it will automatically move on to the next element which is again the title. But that is just a 'performance' thing. The outcome will be the same.</p>",
    "PostedDate": "2011-02-13T23:40:43.73-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "565749",
    "ThreadId": "244704",
    "Html": "<p>thx, you're answer made me look at it again from a different perspective, the solutions turned out to be, that I should use the namelist with id 0 (logically named sort), I assume my author:2 was return an emtpy string or something instead of null cause it has font-styles etc. defined in there, that could have been confusing the sorting.</p>",
    "PostedDate": "2011-02-14T02:20:50.433-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "569006",
    "ThreadId": "244704",
    "Html": "<p>I had to do some adjustment to some code, I would be very thankful if you could say if you think this will work out, as i'm not that secure in xst.</p>\r\n<p>Short summary: I needed to add DocumentFromInternetSite to my file, they are mixed in with the normal internetsites in the bibliography, and internetsites have had their special heading 'websites'. The only difference is their short citation. So I adjusted the heading xsl als follows:</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>&lt;!-- when the preceding source is and internetsite or documentfrominternetsite it shouldn't make another title, as these 2 are mixed just checking for the previous sourcetype isn't enough --&gt;<br />&nbsp;<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">if</span> <span style=\"color: red;\">test</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">not(./b:SourceType = preceding-sibling::b:Source[1]/b:SourceType) and preceding-sibling::b:Source[1]/b:SourceType != 'InternetSite' and preceding-sibling::b:Source[1]/b:SourceType != 'DocumentFromInternetSite'</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\r\n\t   <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">choose</span><span style=\"color: blue;\">&gt;</span>\r\n\t\t<span style=\"color: green;\">&lt;!-- Depending on names, we don't know which of these 2 will be the first entry to create the title --&gt;</span>\r\n\t\t <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">when</span> <span style=\"color: red;\">test</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">./b:SourceType = 'InternetSite' or ./b:SourceType = 'DocumentFromInternetSite'</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\r\n\t\t\t<span style=\"color: green;\">&lt;!--&lt;br clear=\"all\" style=\"page-break-before:always\" /&gt;--&gt;</span>\r\n\t\t\t<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">h6</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">text</span><span style=\"color: blue;\">&gt;</span>Webseiten<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">text</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">h6</span><span style=\"color: blue;\">&gt;</span>\r\n\t\t <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">when</span><span style=\"color: blue;\">&gt;</span>\r\n\t\t <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">when</span> <span style=\"color: red;\">test</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">./b:SourceType = 'Case'</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\r\n\t\t\t<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">h6</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">text</span><span style=\"color: blue;\">&gt;</span>Rechtsprechung<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">text</span><span style=\"color: blue;\">&gt;</span><span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">h6</span><span style=\"color: blue;\">&gt;</span>\r\n\t\t <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">when</span><span style=\"color: blue;\">&gt;</span>\r\n\t\t <span style=\"color: green;\">&lt;!-- ... and so on ... --&gt;</span>\r\n\t   <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">choose</span><span style=\"color: blue;\">&gt;</span>\r\n<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">if</span><span style=\"color: blue;\">&gt;</span>\r\n<br /><br /></pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2011-02-19T09:21:23.043-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "685058",
    "ThreadId": "244704",
    "Html": "<p>Hello,</p>\r\n<p>I just write in this post a solution I found and I think its simpliest possible.</p>\r\n<p>Becouse i had similar problem, i tried method proposed in this topic, and then i used something else</p>\r\n<p>in \"sortkey\" for the first value i typed \"{1}\" for my primary sources, \"{2}\" for secondary sources and so on. It look like:</p>\r\n<p>\"&lt;sortkey&gt;{1}{%Author:0|Editor:0|\"Anon.\"%}{%Year|\"n.d.\"%}{%Title:a|ShortTitle:a%}&lt;/sortkey&gt;\"</p>\r\n<p>\"&lt;sortkey&gt;{2}{%Author:0|Editor:0|\"Anon.\"%}{%Year|\"n.d.\"%}{%Title:a|ShortTitle:a%}&lt;/sortkey&gt;\" etc.</p>\r\n<p>This solution works for me. Maybe there is some kind of problem with this, but for now i prefer to use it as categorizing method for my bibliography.</p>",
    "PostedDate": "2011-10-17T00:51:31.71-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "857123",
    "ThreadId": "244704",
    "Html": "<p>Hey Khuzzuk, thanks for that code - made it so much easier.&nbsp; I don't suppose you had any luck adding headings to each source type?</p>\r\n<p>Thanks a lot,</p>\r\n<p>Laura</p>",
    "PostedDate": "2012-07-03T19:28:08.58-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]