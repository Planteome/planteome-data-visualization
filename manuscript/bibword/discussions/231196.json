[
  {
    "Id": "508388",
    "ThreadId": "231196",
    "Html": "<p>Hi Yves</p>\r\n<p>Fantastic&nbsp;project. After a failed attempt at hacking an existing XSL style sheet I found your solution here.&nbsp;</p>\r\n<p>I'm now using a modified version of the ACS Citation Sequene (Italic) template - and it's working great.</p>\r\n<p>I've read your FAQ as well - and understand that most of the numerical bibliographies use a two column table - and that the first column needs to be adjusted if text for the&nbsp;RefOrder is wrapping because the column is not wide enough.</p>\r\n<p>If I've understood your approach - there is a 'format-bibliography-table-column' xsl template that is being used to create each column (the same template with a single TD)</p>\r\n<p>Would there be a way to test for the column Id? And if it is the&nbsp;first&nbsp;column - set a percentage width so that the table does not have to be adjusted after each bibliography update?</p>\r\n<p>Thoughts?</p>",
    "PostedDate": "2010-10-17T01:26:30.803-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "508393",
    "ThreadId": "231196",
    "Html": "<p>The problem is you can't predict what the end-user's font size will be. What might work for a font size 8, might fail for font size 11. And you also don't know how many references there will be. Less than 10, between 10 and 99, and more than 100 all&nbsp;require different widths for your first column.</p>\r\n<p>Currently, the following line is used to define a table cell:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">td</span> <span style=\"color:red\">align</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">{$params/bibliography/source[@type = $type]/column[@id = $columnId]/halign}</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">valign</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">{$params/bibliography/source[@type = $type]/column[@id = $columnId]/valign}</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span></pre>\r\n</div>\r\n<p>You could rewrite that slighly to take into account a width element. For example just above, you could define a variable colWidth which takes it input depending on column id and then add</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>    <span style=\"color:red\">style</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">width: {$columnWidth}</span><span style=\"color:black\">&quot;</span></pre>\r\n</div>\r\n<p>into the td definition.</p>\r\n<div id=\"_mcePaste\" style=\"width:1px;height:1px;overflow:hidden;top:0px;left:-10000px\">ï»¿</div>\r\n<p>Alternatively, and probably less messy, you could use colspan elements. Right now you have a line</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">table</span> <span style=\"color:red\">width</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">100%</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>Directly under it, you could probably put something like:</p>\r\n<div style=\"color:black;background-color:white\">\r\n<pre>  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">colgroup</span> <span style=\"color:red\">span</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">1&quot;style=&quot;width: 5%</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">colgroup</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">colgroup</span> <span style=\"color:red\">span</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">1</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span><span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">colgroup</span><span style=\"color:blue\">&gt;</span></pre>\r\n</div>\r\n<p>In theory, a simple nowrap should prevent the need of any of the above workarounds, but unfortunately, Word seems to ignore any such HTML 'hints' when importing the table.</p>",
    "PostedDate": "2010-10-17T01:57:51.133-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "508394",
    "ThreadId": "231196",
    "Html": "<p>For example... inside the format-bibliography-table-column template - just before the TD I have...</p>\r\n<p>&nbsp;&lt;xsl:variable name=&quot;width&quot;&gt; &nbsp; &nbsp;<br><span style=\"white-space:pre\"> </span>&lt;xsl:choose&gt;<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;xsl:when test=&quot;$columnId = 1&quot;&gt; <br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;xsl:value-of select=&quot;20&quot;&gt;&lt;/xsl:value-of&gt;<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/xsl:when&gt;<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;xsl:otherwise&gt;<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;xsl:value-of select=&quot;80&quot;&gt;&lt;/xsl:value-of&gt;<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/xsl:otherwise&gt;<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&lt;/xsl:choose&gt;<br>&lt;/xsl:variable&gt;</p>\r\n<p>&nbsp;</p>\r\n<p>And then...</p>\r\n<p>&lt;td width=&quot;{$width}%&quot; align= etc...</p>\r\n<p>Thoughts?</p>\r\n<p>I've got the template working ok - but not sure if the width is being set yet.</p>",
    "PostedDate": "2010-10-17T01:59:28.18-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "508395",
    "ThreadId": "231196",
    "Html": "<p>&nbsp;</p>\r\n<p>Well this is actually working now - but only in Web Layout view of Word :-(</p>\r\n<p>I'm using&nbsp;&lt;td style=&quot;width: {$width}%&quot; &nbsp;for the width setting.</p>\r\n<p>Do you know if there is there an&nbsp;equivalent&nbsp;attribute that will set the width of a column in Print Layout?</p>",
    "PostedDate": "2010-10-17T02:12:02.633-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "619967",
    "ThreadId": "231196",
    "Html": "<p>Hey,</p>\r\n<p>i want define the column width for the first column but i have the same problem like \"abouch\", it only works in the web layout and not in print layout!</p>\r\n<p>Has someone a solution for this problem?</p>\r\n<p>Thx</p>",
    "PostedDate": "2011-05-29T07:37:15.623-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "797735",
    "ThreadId": "231196",
    "Html": "<p>Hi,</p>\n<p>I was running into the same problem and couldn't figure out how to generate a table of the correct width using a \"width\" tag. &nbsp;However, I found out if you add a <a href=\"http://www.fileformat.info/info/unicode/char/A0/index.htm\">non-breaking</a> space after entries with a RefOrder greater than 9 it automagically resizes the column. &nbsp;This is a hack but it seems to do the trick. &nbsp;I haven't tested this with RefOrder greater  than 99 (i.e. 3 digits) but it seems to do the trick for 2 digit numbers.</p>\n<p>Here is the code change:</p>\n<div style=\"color: black; background-color: white;\">\n<pre><div style=\"color: black; background-color: white;\"><pre><span style=\"color: green;\">&lt;!-- Convert the formatted source to html. --&gt;</span>\n<span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">choose</span><span style=\"color: blue;\">&gt;</span>\n  <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">when</span> <span style=\"color: red;\">test</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">msxsl:node-set($data)/general/citation_as_link = 'yes' and $columnId = 1</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\n    <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">a</span> <span style=\"color: red;\">name</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">{$source/b:Tag}</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\n      <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">value-of</span> <span style=\"color: red;\">select</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">$columnX</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">disable-output-escaping</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">yes</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">/&gt;</span>\n      <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">if</span> <span style=\"color: red;\">test</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">number($source/b:RefOrder) &gt; 9</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\n      &amp;#xa0;\n      <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">if</span><span style=\"color: blue;\">&gt;</span>\n    <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">a</span><span style=\"color: blue;\">&gt;</span>\n  <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">when</span><span style=\"color: blue;\">&gt;</span>\n  <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">otherwise</span><span style=\"color: blue;\">&gt;</span>\n    <span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">value-of</span> <span style=\"color: red;\">select</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">$columnX</span><span style=\"color: black;\">\"</span> <span style=\"color: red;\">disable-output-escaping</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">yes</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">/&gt;</span>\n  <span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">otherwise</span><span style=\"color: blue;\">&gt;</span>\n<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">choose</span><span style=\"color: blue;\">&gt;</span></pre>\n</div>\n</pre>\n</div>\n<p>The new code is:</p>\n<div style=\"color: black; background-color: white;\">\n<pre><span style=\"color: blue;\">&lt;</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">if</span> <span style=\"color: red;\">test</span><span style=\"color: blue;\">=</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">number($source/b:RefOrder) &gt; 9</span><span style=\"color: black;\">\"</span><span style=\"color: blue;\">&gt;</span>\n              &amp;#xa0;\n<span style=\"color: blue;\">&lt;/</span><span style=\"color: #a31515;\">xsl</span><span style=\"color: blue;\">:</span><span style=\"color: #a31515;\">if</span><span style=\"color: blue;\">&gt;</span></pre>\n</div>\n<pre>&amp;#xa0; is the unicode for non-breaking space.</pre>\n<pre>Hope this helps.</pre>",
    "PostedDate": "2012-02-23T07:47:06.81-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "798208",
    "ThreadId": "231196",
    "Html": "<p>Interesting. While whitespace: nowrap doesn't work, a non-breaking space does? Shows that there clearly is something wrong with Word's interpretation of HTML.</p>\r\n<p>Thanks for sharing.</p>",
    "PostedDate": "2012-02-23T12:59:02.09-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]