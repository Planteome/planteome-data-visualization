[
  {
    "Id": "255536",
    "ThreadId": "74667",
    "Html": "<p>Hey,</p>\r\n<p>&nbsp;</p>\r\n<p>my Professor is using his own very complex citation style. With Bibword i was able to make all the things he wants possible(expect one)..</p>\r\n<p>First I want to thank you for this!!!</p>\r\n<p>My Last topic is that he wan'ts differnet headings/groups in the bibliography.</p>\r\n<p>&nbsp;</p>\r\n<p>example:</p>\r\n<p>BOOKS:</p>\r\n<p>author1, year 1 ...</p>\r\n<p>author2, year 2 ...</p>\r\n<p>&nbsp;</p>\r\n<p>NEWSPAPERS:</p>\r\n<p>blabla</p>\r\n<p>&nbsp;</p>\r\n<p>INTERNET SOURCES:</p>\r\n<p>author3 , www......</p>\r\n<p>author4, year, wwww..</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>I was able to sort in the right way. Same sources are grouped together in the moment. I'm also able to output the sourcetype with every author:</p>\r\n<p>&nbsp;</p>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:305px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&lt;xsl:if test=&quot;$sourcetype='Book'&quot;&gt;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:305px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;!--&lt;xsl:text&gt;&amp;lt;b&amp;gt; &lt;/xsl:text&gt; --&gt;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:305px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;xsl:text&gt; Buch &lt;/xsl:text&gt;</div>\r\n<div id=\"_mcePaste\" style=\"left:-10000px;top:305px;width:1px;height:1px;overflow-x:hidden;overflow-y:hidden\">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/xsl:if&gt;</div>\r\n<p>\r\n<p>&nbsp;&lt;xsl:if test=&quot;$sourcetype='Book'&quot;</p>\r\n<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;xsl:text&gt; BOOKS &lt;/xsl:text&gt;</p>\r\n<p>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/xsl:if&gt;</p>\r\n</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>But i don't need it with EVERY author, only once.&nbsp;</p>\r\n<p>Is this possible? How?</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks Joe</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-11-10T07:55:00.12-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "255603",
    "ThreadId": "74667",
    "Html": "<p>BibWord does not provide support for headings at the moment.</p>\r\n<p>But it is pretty easy to adjust the stylesheet to support your specific case. I'm assuming that you are not using a table layout but rather a simple paragraph layout. Look for the template &quot;format-bibliography-as-paragraphs&quot;. The template looks like this:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>  <span style=\"color:Green\">&lt;!-- Formats a bibliography as a series of paragraphs. --&gt;</span>\r\n  <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">template</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">format-bibliography-as-paragraphs</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">param</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">bibNodeSet</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n\r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">for-each</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">$bibNodeSet/b:Bibliography/b:Source</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">sort</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">b:SortKey</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">data-type</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">text</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n   \r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">p</span> <span style=\"color:Red\">class</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">MsoBibliography</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Green\">&lt;!-- A bunch of code. --&gt;</span>\r\n      <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">p</span><span style=\"color:Blue\">&gt;</span>\r\n\r\n    <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">for-each</span><span style=\"color:Blue\">&gt;</span>\r\n\r\n  <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">template</span><span style=\"color:Blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>What you can do is replace the top of this code with the following code (everything above the &quot;p&quot; element):</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>  <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">template</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">format-bibliography-as-paragraphs</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">param</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">bibNodeSet</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span><span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">param</span><span style=\"color:Blue\">&gt;</span>\r\n\r\n    <span style=\"color:Green\">&lt;!-- pre-sort the entries to allow preceding-sibling lookup. --&gt;</span>\r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">variable</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">presorted</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">b</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">Bibliography</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">for-each</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">$bibNodeSet/b:Bibliography/b:Source</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">sort</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">b:SortKey</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">data-type</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">text</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n\r\n          <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">b</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">Source</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">copy-of</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">./*</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span><span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">copy-of</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">b</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">Source</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">for-each</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">b</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">Bibliography</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">variable</span><span style=\"color:Blue\">&gt;</span>\r\n    \r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">for-each</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">msxsl:node-set($presorted)/b:Bibliography/b:Source</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Green\">&lt;!--&lt;xsl:sort select=&quot;b:SortKey&quot; data-type=&quot;text&quot;&gt;&lt;/xsl:sort&gt;--&gt;</span>\r\n\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">if</span> <span style=\"color:Red\">test</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">not(./b:SourceType = preceding-sibling::b:Source[1]/b:SourceType)</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">h4</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">value-of</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">./b:SourceType</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n        <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">h4</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">if</span><span style=\"color:Blue\">&gt;</span>\r\n      \r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">p</span> <span style=\"color:Red\">class</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">MsoBibliography</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Green\">&lt;!-- A bunch of code. --&gt;</span>\r\n      <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">p</span><span style=\"color:Blue\">&gt;</span>\r\n\r\n    <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">for-each</span><span style=\"color:Blue\">&gt;</span>\r\n\r\n  <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">template</span><span style=\"color:Blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>The above code assumes that you already sort by SourceType (something you do according to your message). It presorts your entries so that SourceTypes of successive entries can be compared to decide when a new SourceType comes up. The code:</p>\r\n</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>  <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">h4</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">value-of</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">./b:SourceType</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n  <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">h4</span><span style=\"color:Blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>\r\n<p>is what is shown on top of each category. If you don't like the strings, you can replace them with your own. The quickest way would be:</p>\r\n</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre>  <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">h4</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">choose</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span> <span style=\"color:Red\">test</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">./b:SourceType = 'BookSection'</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>Book Section<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span> <span style=\"color:Red\">test</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">./b:SourceType = 'JournalArticle'</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>Journal Paper<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Green\">&lt;!-- ... and so on ... --&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">otherwise</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">value-of</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">./b:SourceType</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n      <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">otherwise</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">choose</span><span style=\"color:Blue\">&gt;</span>\r\n  <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">h4</span><span style=\"color:Blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>The otherwise is a fallback mechanism in case you didn't provide a string for a specific type. (Note that in the latest version of BibWord, you could query that string from the data element).</p>\r\n<p>The &quot;h4&quot; element is only there as an example. You can add any p or hX element you want.</p>",
    "PostedDate": "2009-11-10T09:55:32.487-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "264445",
    "ThreadId": "74667",
    "Html": "<p>this is great! but how do I sort by SourceType? i modified &lt;xsl:variable name=&quot;extendedBib&quot;&gt; with a &lt;xsl:sort select=&quot;./b:SourceType&quot;/&gt; but maybe it's the &lt;b:SortKey&gt; i should modify?</p>\r\n<p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Green\">&lt;!-- Extends the b:Source elements of the b:Bibliography element with a b:SortKey. --&gt;</span>\r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">variable</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">extendedBib</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Green\">&lt;!-- Create a b:Bibliography element. --&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">b</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">Bibliography</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Green\">&lt;!-- Extend all the b:Source elements with a sortkey. --&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">for-each</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/b:Bibliography/b:Source</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">sort</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">./b:SourceType</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n</pre>\r\n</div>\r\n</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-12-07T05:26:29.057-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "264457",
    "ThreadId": "74667",
    "Html": "<p>Yes, each <em>&lt;b:SortKey&gt;</em> element should start with <em>{%SourceType% }</em> to ensure initial sorting on type.</p>",
    "PostedDate": "2009-12-07T06:12:01.867-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]