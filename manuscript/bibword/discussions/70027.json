[
  {
    "Id": "238487",
    "ThreadId": "70027",
    "Html": "<p>Hi Yves,</p>\r\n<p>From a previous discussion, I downloaded the special Harvard Anglia that sorts the dates from newest to oldest you had posted here (http://allserv.ugent.be/~ydhondt) and it did indeed solve the reverse order perfectly, thank you.</p>\r\n<p>I was also trying to run the BibWord Extender tool to add letter suffixes to the years in which I had the same author multiple times within a year. It kept giving me error messages. You had advised me:</p>\r\n<p>&quot;It sounds as if you don't have the .Net framework 3.5 (which contains WindowsBase.dll) installed. See the requirements section at <a href=\"../Release/ProjectReleases.aspx?ReleaseId=24823\">http://bibword.codeplex.com/Release/ProjectReleases.aspx?ReleaseId=24823&quot;</a></p>\r\n<p>I did download and install the .Net framework 3.5, and that solved part of the problem - no more error messages. Now I close my Word document with the bibliography in it, run the BibWord extender tool (version 2.0), and it tells me it's been extended. However, when I re-open the document, there are no extensions. I am using Word 2007 on a PC. I tried updating the fields, tried switching to a different style then back again, didn't work.</p>\r\n<p>My source type is report, and I am using the corporate author field.</p>\r\n<p>In addition, is there any way I can change my in-text citations to be a short version of the author name? For instance the bibliography entry is &quot;Long Company Name. 2006&quot; and I want it to show in the citation as &quot;LCN 2006&quot; - I have tried editing the citation field, but it only has options to suppress things, and I can't type over the existing text, either. If I use a different field to enter that short author info, is there somewhere for me to change the field the citation uses to pull text?</p>\r\n<p>Any help would be appreciated.</p>",
    "PostedDate": "2009-09-24T13:12:47.957-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "238529",
    "ThreadId": "70027",
    "Html": "<p>The BibWord Extender tool only extends the internals. When you then open your document again in Word, selecting your style again from the drop down list should update all citation and bibliography fields. If it doesn't work directly, try switching to another style and back.</p>\r\n<p>If you still don't see any year suffices, you can manually check if BibWord Extender completed its task successfully. Create a copy of your docx file and change the extension from docx to zip.&nbsp;Open the zip archive. Look in the customXml directory for a file called item1.xml (name could be different, but its very unlikely). In it, you will find all your sources. Check if you find a BibOrder tag (&lt;BibOrder&gt;). If not, then there was no extension. If there is one, then there was an extension. If it is empty while it shouldn't be, chances are your formatting rules do not define matches which require a suffix. At first glance, it doesn't seem anything is wrong with the formatting rules, but you might want to verify them anyway.</p>\r\n<p>&nbsp;</p>\r\n<p>&nbsp;</p>\r\n<p>You can not directly switch to a short version as Word has no idea as to what a short version of your name would be. However, there is a workaround. You can add a prefix to any citation using the /f flag in Word. That in combination with suppressing the authors should do the trick for you.</p>\r\n<p>Right click on your in-text citation and select &quot;Edit field...&quot;. A dialog will popup with on the right a string looking like:</p>\r\n<p style=\"padding-left:30px\">CITATION Bou022 \\l 1033</p>\r\n<p>In the above example Bou022 is the tag of the source while 1033 is the language used. So both could be different on your machine. What you want to do is first suppress the author by adding the \\n switch and then adding a prefix using the \\f switch. So you would get:</p>\r\n<p style=\"padding-left:30px\">CITATION Bou022 \\n \\f &quot;LCN&quot; \\l 1033</p>\r\n<p>Note that if you always want to use that short version with corporate authors, you could write a short abbreviation routine in the XSLT (or try reusing the one there is for name) and add it as an extra option. Look for the comment line &quot;&lt;!-- Format the corporate parameter. --&gt;&quot; to get an idea as to where to define your option. Currently, &quot;u&quot; (uppercase) and &quot;l&quot; (lowercase) are defined, but you could add an &quot;a&quot; for abbreviated for example. But remember, it will then be used for all citations. There is no automated&nbsp;way to tell that the first time a citation should be in full and abbreviated in all following cases.</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-09-24T14:30:54.633-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "238587",
    "ThreadId": "70027",
    "Html": "<p>I followed your directions above regarding saving it as a zip file and checking the file called item1.xml. There was no BibOrder anywhere in the file.&nbsp; How can I change the formatting rules to define matches which require a suffix?</p>\r\n<p>I see your point about Word having no idea what the short version should be. Your &quot;edit field&quot; instruction worked perfectly. That will get me by, and is much better off than I was. However, it is true that I will always want to use the short form for in-text citations. I found the code for &quot;format the corporate parameter&quot;, but I can't figure out which portion of the code thereafter is for name - I see &quot;u&quot; for uppercase and &quot;l&quot; for lowercase...I am clueless...is it something in here I need to edit:</p>\r\n<div><span><a style=\"visibility:hidden\">-</a> <span>&lt;!--</span></span> <span>\r\n<pre> Abbreviate a name (or part of a name if called recursively). </pre>\r\n</span><span>&nbsp;</span> <span>--&gt;</span>\r\n&lt;script type=&quot;text/javascript&quot;&gt;// &lt;![CDATA[\r\nf(clean);\r\n// ]]&gt;&lt;/script&gt;\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:template</span><span> name</span><span>=&quot;</span><strong>abbreviate-name</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div><span><a style=\"visibility:hidden\">-</a> <span>&lt;!--</span></span> <span>\r\n<pre> Name or part of name to abbreviate. </pre>\r\n</span><span>&nbsp;</span> <span>--&gt;</span>\r\n&lt;script type=&quot;text/javascript&quot;&gt;// &lt;![CDATA[\r\nf(clean);\r\n// ]]&gt;&lt;/script&gt;\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:param</span> <span>name</span><span>=&quot;</span><strong>name</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div><span><a style=\"visibility:hidden\">-</a> <span>&lt;!--</span></span> <span>\r\n<pre> Flag indicating if abbreviated parts should be followed by a period (1) or not (0). </pre>\r\n</span><span>&nbsp;</span> <span>--&gt;</span>\r\n&lt;script type=&quot;text/javascript&quot;&gt;// &lt;![CDATA[\r\nf(clean);\r\n// ]]&gt;&lt;/script&gt;\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:param</span> <span>name</span><span>=&quot;</span><strong>withPeriods</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>1</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div><span><a style=\"visibility:hidden\">-</a> <span>&lt;!--</span></span> <span>\r\n<pre> Flag indicating if spaces between abbreviated parts should be kept (1) or not (0). </pre>\r\n</span><span>&nbsp;</span> <span>--&gt;</span>\r\n&lt;script type=&quot;text/javascript&quot;&gt;// &lt;![CDATA[\r\nf(clean);\r\n// ]]&gt;&lt;/script&gt;\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:param</span> <span>name</span><span>=&quot;</span><strong>keepSpaces</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>1</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div><span><a style=\"visibility:hidden\">-</a> <span>&lt;!--</span></span> <span>\r\n<pre> Flag indicating if dashes between abbreviated parts should be kept (1) or not (0). </pre>\r\n</span><span>&nbsp;</span> <span>--&gt;</span>\r\n&lt;script type=&quot;text/javascript&quot;&gt;// &lt;![CDATA[\r\nf(clean);\r\n// ]]&gt;&lt;/script&gt;\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:param</span> <span>name</span><span>=&quot;</span><strong>keepDashes</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>1</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:choose</span><span>&gt;</span></div>\r\n<div>\r\n<div><span><a style=\"visibility:hidden\">-</a> <span>&lt;!--</span></span> <span>\r\n<pre> Handle 'A-B' </pre>\r\n</span><span>&nbsp;</span> <span>--&gt;</span>\r\n&lt;script type=&quot;text/javascript&quot;&gt;// &lt;![CDATA[\r\nf(clean);\r\n// ]]&gt;&lt;/script&gt;\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:when</span><span> test</span><span>=&quot;</span><strong>contains($name, '-')</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:call-template</span><span> name</span><span>=&quot;</span><strong>abbreviate-name</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>name</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>substring-before(normalize-space($name), '-')</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>withPeriods</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$withPeriods</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>keepSpaces</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$keepSpaces</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>keepDashes</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$keepDashes</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:call-template</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:if</span><span> test</span><span>=&quot;</span><strong>$keepDashes = 1</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:text</span><span>&gt;</span><span>-</span><span>&lt;/</span><span>xsl:text</span><span>&gt;</span></div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:if</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:call-template</span><span> name</span><span>=&quot;</span><strong>abbreviate-name</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>name</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>substring-after(normalize-space($name), '-')</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>withPeriods</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$withPeriods</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>keepSpaces</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$keepSpaces</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>keepDashes</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$keepDashes</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:call-template</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:when</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div><span><a style=\"visibility:hidden\">-</a> <span>&lt;!--</span></span> <span>\r\n<pre> Handle 'A B' </pre>\r\n</span><span>&nbsp;</span> <span>--&gt;</span>\r\n&lt;script type=&quot;text/javascript&quot;&gt;// &lt;![CDATA[\r\nf(clean);\r\n// ]]&gt;&lt;/script&gt;\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:when</span><span> test</span><span>=&quot;</span><strong>contains($name, ' ')</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:call-template</span><span> name</span><span>=&quot;</span><strong>abbreviate-name</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>name</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>substring-before(normalize-space($name), ' ')</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>withPeriods</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$withPeriods</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>keepSpaces</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$keepSpaces</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>keepDashes</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$keepDashes</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:call-template</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:if</span><span> test</span><span>=&quot;</span><strong>$keepSpaces = 1</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:text</span> <span>/&gt;</span></div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:if</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:call-template</span><span> name</span><span>=&quot;</span><strong>abbreviate-name</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>name</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>substring-after(normalize-space($name), ' ')</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>withPeriods</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$withPeriods</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>keepSpaces</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$keepSpaces</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>keepDashes</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$keepDashes</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:call-template</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:when</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div><span><a style=\"visibility:hidden\">-</a> <span>&lt;!--</span></span> <span>\r\n<pre> Handle 'A.B.'</pre>\r\n</span><span>&nbsp;</span> <span>--&gt;</span>\r\n&lt;script type=&quot;text/javascript&quot;&gt;// &lt;![CDATA[\r\nf(clean);\r\n// ]]&gt;&lt;/script&gt;\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:when</span><span> test</span><span>=&quot;</span><strong>contains($name, '.') and  string-length(substring-after($name, '.')) &gt; 0</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:call-template</span><span> name</span><span>=&quot;</span><strong>abbreviate-name</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>name</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>substring-before(normalize-space($name), '.')</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>withPeriods</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$withPeriods</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>keepSpaces</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$keepSpaces</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>keepDashes</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$keepDashes</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:call-template</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:if</span><span> test</span><span>=&quot;</span><strong>$keepSpaces = 1</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:text</span> <span>/&gt;</span></div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:if</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:call-template</span><span> name</span><span>=&quot;</span><strong>abbreviate-name</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>name</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>substring-after(normalize-space($name), '.')</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>withPeriods</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$withPeriods</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>keepSpaces</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$keepSpaces</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:with-param</span> <span>name</span><span>=&quot;</span><strong>keepDashes</strong><span>&quot;</span><span> select</span><span>=&quot;</span><strong>$keepDashes</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:call-template</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:when</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:otherwise</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:if</span><span> test</span><span>=&quot;</span><strong>string-length($name) &gt; 0</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:value-of</span> <span>select</span><span>=&quot;</span><strong>substring($name,1,1)</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:if</span><span> test</span><span>=&quot;</span><strong>$withPeriods = 1</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:text</span><span>&gt;</span><span>.</span><span>&lt;/</span><span>xsl:text</span><span>&gt;</span></div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:if</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:if</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:otherwise</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:choose</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div><span>&nbsp;</span> <span>&lt;/</span><span>xsl:template</span><span>&gt;</span></div>\r\n</div>\r\n</div>\r\n<div><span><a style=\"visibility:hidden\">-</a> <span>&lt;!--</span></span> <span>\r\n<pre> Abbreviates a string to its capital letters only. </pre>\r\n</span><span>&nbsp;</span> <span>--&gt;</span>\r\n&lt;script type=&quot;text/javascript&quot;&gt;// &lt;![CDATA[\r\nf(clean);\r\n// ]]&gt;&lt;/script&gt;\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><a href=\"#\">-</a> <span>&lt;</span><span>xsl:template</span><span> name</span><span>=&quot;</span><strong>abbreviate-to-capitals</strong><span>&quot;</span><span>&gt;</span></div>\r\n<div>\r\n<div><span><a style=\"visibility:hidden\">-</a> <span>&lt;!--</span></span> <span>\r\n<pre> String to abbreviate. </pre>\r\n</span><span>&nbsp;</span> <span>--&gt;</span>\r\n&lt;script type=&quot;text/javascript&quot;&gt;// &lt;![CDATA[\r\nf(clean);\r\n// ]]&gt;&lt;/script&gt;\r\n</div>\r\n<div>\r\n<div style=\"margin-left:1em;text-indent:-2em\"><span>&nbsp;</span> <span>&lt;</span><span>xsl:param</span> <span>name</span><span>=&quot;</span><strong>string</strong><span>&quot;</span><span> /&gt;</span></div>\r\n</div>\r\n</div>\r\n</div>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-09-24T18:36:08.057-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "238646",
    "ThreadId": "70027",
    "Html": "<p>I tested it with that specific style and I did get year suffices. Are you sure the names are exactly the same? For example &quot;United Nations&quot; is not the same as &quot;united nations&quot;. If you still have a problem, mail me a small piece of text containing about 5 citations of which 2-3 should have a year suffix together with your stylesheet so I can look into it (probably won't be in the first few days). My email can normally be found at the top of your stylesheet.</p>\r\n<p>Where the corporate element is formatted, you currently have 2 options: uppercase and lowercase</p>\r\n<p>&nbsp;<span style=\"color:Green\">&lt;!-- Format the corporate parameter. --&gt;</span><br><span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">choose</span><span style=\"color:Blue\">&gt;</span><br>&nbsp; <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span> <span style=\"color:Red\">test</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">contains($options, 'u')</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span><br>&nbsp;&nbsp;&nbsp; <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">call-template</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">upper-case</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">with-param</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">string</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">$corporate</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span><br>&nbsp;&nbsp;&nbsp; <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">call-template</span><span style=\"color:Blue\">&gt;</span><br>&nbsp; <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span><span style=\"color:Blue\">&gt;</span><br>&nbsp; <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span> <span style=\"color:Red\">test</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">contains($options, 'l')</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span><br>&nbsp;&nbsp;&nbsp; <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">call-template</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">lower-case</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">with-param</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">string</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">$corporate</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span><br>&nbsp;&nbsp;&nbsp; <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">call-template</span><span style=\"color:Blue\">&gt;</span><br>&nbsp; <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span><span style=\"color:Blue\">&gt;</span><br>&nbsp; <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">otherwise</span><span style=\"color:Blue\">&gt;</span><br>&nbsp;&nbsp;&nbsp; <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">value-of</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">$corporate</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span><br>&nbsp; <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">otherwise</span><span style=\"color:Blue\">&gt;</span><br><span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">choose</span><span style=\"color:Blue\">&gt;</span></p>\r\n<p>What you could do is add a third option 'a' which acts similar to the abbreviation of name parts:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Green\">&lt;!-- Format the corporate parameter. --&gt;</span>\r\n<span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">choose</span><span style=\"color:Blue\">&gt;</span>\r\n  <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span> <span style=\"color:Red\">test</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">contains($options, 'u')</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">call-template</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">upper-case</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">with-param</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">string</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">$corporate</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n    <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">call-template</span><span style=\"color:Blue\">&gt;</span>\r\n  <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span><span style=\"color:Blue\">&gt;</span>\r\n  <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span> <span style=\"color:Red\">test</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">contains($options, 'l')</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">call-template</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">lower-case</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">with-param</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">string</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">$corporate</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n    <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">call-template</span><span style=\"color:Blue\">&gt;</span>\r\n  <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span><span style=\"color:Blue\">&gt;</span>\r\n  <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span> <span style=\"color:Red\">test</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">contains($options, 'a')</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">call-template</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">abbreviate-name</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">with-param</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">name</span><span style=\"color:Black\">&quot;</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">$corporate</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">with-param</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">keepDashes</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">choose</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span> <span style=\"color:Red\">test</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">contains($options, 'd')</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>1<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">otherwise</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>0<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">otherwise</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">choose</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">with-param</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">with-param</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">withPeriods</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">choose</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span> <span style=\"color:Red\">test</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">contains($options, 'p')</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>1<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">otherwise</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>0<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">otherwise</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">choose</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">with-param</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">with-param</span> <span style=\"color:Red\">name</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">keepSpaces</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">choose</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span> <span style=\"color:Red\">test</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">contains($options, 's')</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>1<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">otherwise</span><span style=\"color:Blue\">&gt;</span>\r\n            <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>0<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">text</span><span style=\"color:Blue\">&gt;</span>\r\n          <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">otherwise</span><span style=\"color:Blue\">&gt;</span>\r\n        <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">choose</span><span style=\"color:Blue\">&gt;</span>\r\n      <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">with-param</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">call-template</span><span style=\"color:Blue\">&gt;</span>\r\n  <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">when</span><span style=\"color:Blue\">&gt;</span>\r\n  <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">otherwise</span><span style=\"color:Blue\">&gt;</span>\r\n    <span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">value-of</span> <span style=\"color:Red\">select</span><span style=\"color:Blue\">=</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">$corporate</span><span style=\"color:Black\">&quot;</span><span style=\"color:Blue\">/&gt;</span>\r\n  <span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">otherwise</span><span style=\"color:Blue\">&gt;</span>\r\n<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">xsl</span><span style=\"color:Blue\">:</span><span style=\"color:#A31515\">choose</span><span style=\"color:Blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>So then, you can change the format string for corporate authors in the namelist from:</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">corporate</span><span style=\"color:Blue\">&gt;</span>{%Corporate%}<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">corporate</span><span style=\"color:Blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>into</p>\r\n<div style=\"color:Black;background-color:White\">\r\n<pre><span style=\"color:Blue\">&lt;</span><span style=\"color:#A31515\">corporate</span><span style=\"color:Blue\">&gt;</span>{%Corporate:a%}<span style=\"color:Blue\">&lt;/</span><span style=\"color:#A31515\">corporate</span><span style=\"color:Blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n<p>That way, all corporate names will be abbreviated without spaces (s), dashes (d), or periods (p).</p>",
    "PostedDate": "2009-09-24T23:52:34.087-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "242755",
    "ThreadId": "70027",
    "Html": "<p>Somehow, the year suffices are now miraculously working, I don't know what changed. However, this has revealed yet another issue.</p>\r\n<p>I successfully changed the sort order for source type report:<br><br>&lt;source type=&quot;Report&quot;&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;column id=&quot;1&quot;&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;halign&gt;left&lt;/halign&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;valign&gt;top&lt;/valign&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;format&gt;{ %ThesisType%}{ %Author:2|&quot;Anon.&quot;%}.}{ %Year|&quot;n.d.&quot;%{%YearSuffix%}.}{ &amp;lt;i&amp;gt;%Title|ShortTitle%&amp;lt;/i&amp;gt;.}{ %City|CountryRegion%{, %CountryRegion%}{: %Publisher|Institution%}}{ %Publisher|Institution%}.{ %StandardNumber%.}.{ %Comments%.}{ %Month%}.}&lt;/format&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/column&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;sortkey&gt;{%Author:0|&quot;Anon.&quot;%}{%Year|&quot;n.d.&quot;%}{%Month%}{%Title:a|ShortTitle:a%}&lt;/sortkey&gt;<br><br>I thought it was perfect, but it is perceiving the month field as an alphabetical sort, not numerical, so my output is like this:<br><br>Client Name. 2006a. The Geology of the Eastern Part of Client Name. SLAC-I-750-3A33X-001. February.<br>Client Name. 2006b. More Testing for Same Author in Same Year. November.<br>Client Name. 2006c. Testing a Document for Multiple Documents by Same Author within Same Year. SLAC-XX-Test. October.<br><br>Where &quot;F&quot; comes before &quot;N&quot;, and &quot;N&quot; comes before &quot;O,&quot; instead of February, October, November.</p>\r\n<p>How can I assign a numerical value to the months? I thought this bit of code already did that:</p>\r\n<p>&lt;/list&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/namelists&gt;<br>&nbsp;&nbsp;&nbsp; &lt;strings&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;months&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;month number=&quot;1&quot;&gt;January&lt;/month&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;month number=&quot;2&quot;&gt;February&lt;/month&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;month number=&quot;3&quot;&gt;March&lt;/month&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;month number=&quot;4&quot;&gt;April&lt;/month&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;month number=&quot;5&quot;&gt;May&lt;/month&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;month number=&quot;6&quot;&gt;June&lt;/month&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;month number=&quot;7&quot;&gt;July&lt;/month&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;month number=&quot;8&quot;&gt;Augustus&lt;/month&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;month number=&quot;9&quot;&gt;September&lt;/month&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;month number=&quot;10&quot;&gt;October&lt;/month&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;month number=&quot;11&quot;&gt;November&lt;/month&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;month number=&quot;12&quot;&gt;December&lt;/month&gt;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/months&gt;<br>&nbsp;&nbsp;&nbsp; &lt;/strings&gt;</p>\r\n<p>What am I missing?</p>\r\n<p>&nbsp;</p>",
    "PostedDate": "2009-10-06T16:44:44.003-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "242856",
    "ThreadId": "70027",
    "Html": "<p>That last bit of code is actually meant for the opposite action: if the month is represented by a number, then this part can translate the number into a string. The other way around would be a lot harder to achieve as the stylesheet would only be able to guess in what language you entered a month's name&nbsp;and if it was abbreviated or not. Note that numbers get only translated to strings if the <strong>s</strong> option is activated ( %Month:<strong>s</strong>% )</p>\r\n<p>But even if you entered the month as a number (something which you should do), there is still an issue with sorting. The sortkey which is generated is a string, meaning that no part of it is sorted as a numeral. So &quot;2006 12&quot; would be before &quot;2006 3&quot;. The solution to that would be to ensure that a month is always represented by 2 digits. There currently is no such functionality build into BibWord. There is such functionality for Days (the <strong>n</strong> option). So it&nbsp;should be easy to&nbsp;see how it is done in the format-day template and use that information to extend the format-month template. It is actually a good idea to have such formatting option so I'll probably add it to the next BibWord release.</p>",
    "PostedDate": "2009-10-07T01:47:38.613-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]