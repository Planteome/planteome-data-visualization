[
  {
    "Id": "514828",
    "ThreadId": "232860",
    "Html": "\r\n<p>I'm using the following format string for an Internet Site source type:</p>\r\n<p><span>&lt;</span><span>format</span><span>&gt;</span>{%Author:2|&quot;Anon.&quot;%}{ &quot;%Title%,&quot;}{ in:%InternetSiteTitle%,}{ Available at:\r\n<span>&amp;lt;</span>u<span>&amp;gt;</span>%URL:l%<span>&amp;lt;</span>/u<span>&amp;gt;</span>}{ [Accessed{ %MonthAccessed:s%}{ %DayAccessed%,} %YearAccessed%]}{ %Year|&quot;n.d.&quot;%}.<span>&lt;/</span><span>format</span><span>&gt;</span></p>\r\n<p>Whenever the citation appears in the Bibliography, the Year always shows up as &quot;n.d.&quot;. However, if I move the { %Year|&quot;n.d.&quot;%} tag so that it is placed before the &quot;Accessed&quot; tag, then the date shows up fine. Oddly enough, if I simply remove the %YearAccessed%\r\n tag, then the %Year% tag displays correctly. It's as if the use of the %YearAccessed% tag is erasing the contents of the %Year% tag, but not the other way around.</p>\r\n<p>Any ideas on what might cause this?</p>\r\n<p>P.s. I should mention that this problem seems to occur in both Word 2010 and Word for Mac 2011. I haven't tried this with Word 2007, though.</p>\r\n",
    "PostedDate": "2010-10-29T21:51:54.413-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "514918",
    "ThreadId": "232860",
    "Html": "\r\n<p>Quick and easy workaround in your case: add an 'r' option after YearAccessed. So your line would become</p>\r\n<p><span>&lt;</span><span>format</span><span>&gt;</span>{%Author:2|&quot;Anon.&quot;%}{ &quot;%Title%,&quot;}{ in:%InternetSiteTitle%,}{ Available at:\r\n<span>&amp;lt;</span>u<span>&amp;gt;</span>%URL:l%<span>&amp;lt;</span>/u<span>&amp;gt;</span>}{ [Accessed{ %MonthAccessed:s%}{ %DayAccessed%,} %YearAccessed<strong><span style=\"color:#ff0000\">:r</span></strong>%]}{ %Year|&quot;n.d.&quot;%}.<span>&lt;/</span><span>format</span><span>&gt;</span></p>\r\n<p><span>But this is really a bug in BibWord which affects all parameters which have a name which is the start of the name of another parameter (Day, Month, Year). A full fix would be to change the following three lines in the code (I will incorporate them\r\n in the next release but you can already do it yourself if you want). </span></p>\r\n<p><span>Change (1)</span></p>\r\n<p><span></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">with-param</span> <span style=\"color:red\">name</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">used</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">select</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">concat($used, $usedAtCurrentLevel)</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n</pre>\r\n</div>\r\n</span>\r\n<p></p>\r\n<p><span>into</span></p>\r\n<p><span></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">with-param</span> <span style=\"color:red\">name</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">used</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">select</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">concat(concat($used, $usedAtCurrentLevel), '-')</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">/&gt;</span>\r\n</pre>\r\n</div>\r\n</span>\r\n<p></p>\r\n<p><span>and change (2)</span></p>\r\n<p><span></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">when</span> <span style=\"color:red\">test</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">(($name != 'Author' and string($source/*[local-name() = $name])) or string($source/b:Author/*[local-name() = $name])) and not(contains($used, concat('-', $name)))</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n</span>\r\n<p></p>\r\n<p><span>into</span></p>\r\n<p><span></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">when</span> <span style=\"color:red\">test</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">(($name != 'Author' and string($source/*[local-name() = $name])) or string($source/b:Author/*[local-name() = $name])) and not(contains($used, concat(concat('-', $name), '-')))</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n</span>\r\n<p></p>\r\n<p><span>and change (3)</span></p>\r\n<p><span></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">when</span> <span style=\"color:red\">test</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">starts-with($name, '&amp;#x22;') and substring($name, string-length($name), 1) = '&amp;#x22;' and not(contains($used, concat('-', $name)))</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n</span>\r\n<p></p>\r\n<p><span>into</span></p>\r\n<p><span></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">xsl</span><span style=\"color:blue\">:</span><span style=\"color:#a31515\">when</span> <span style=\"color:red\">test</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">starts-with($name, '&amp;#x22;') and substring($name, string-length($name), 1) = '&amp;#x22;' and not(contains($used, concat(concat('-', $name), '-')))</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span></pre>\r\n</div>\r\n<p>Thanks for reporting this.</p>\r\n</span>\r\n<p></p>\r\n",
    "PostedDate": "2010-10-30T07:41:44.523-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "514920",
    "ThreadId": "232860",
    "Html": "\r\n<p>yves,</p>\r\n<p>Thank you! The fix worked perfectly!</p>\r\n",
    "PostedDate": "2010-10-30T07:51:42.27-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]